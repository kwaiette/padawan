{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":true}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$4","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$5","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$6","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$7","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$9","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}}],"presets":[],"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan\\imports\\ui\\pages\\team_goals\\team_goals.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining","pipelineOperator","throwExpressions","dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"imports/ui/pages/team_goals/team_goals.js","filename":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan\\imports\\ui\\pages\\team_goals\\team_goals.js","passPerPreset":false,"envName":"development","cwd":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan","root":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan","generatorOpts":{"filename":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan\\imports\\ui\\pages\\team_goals\\team_goals.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/ui/pages/team_goals/team_goals.js"}},"code":"let Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 1);\nlet TeamGoal;\nmodule.watch(require(\"/imports/api/team_goals/team_goals.js\"), {\n  TeamGoal(v) {\n    TeamGoal = v;\n  }\n\n}, 2);\nmodule.watch(require(\"./team_goals.html\"));\nmodule.watch(require(\"/imports/ui/components/select_autocomplete/select_autocomplete.js\"));\nconst BLANK_GOAL = {\n  _id: \"new\",\n  title: \"\",\n  description: \"\"\n};\n\nlet _hasSubgoalView = new ReactiveVar(false);\n\nlet _subgoalId = new ReactiveVar(\"\");\n\nTemplate.team_goals.onCreated(function () {\n  if (this.data.teamName) {\n    this.teamName = this.data.teamName;\n  } else {\n    this.teamName = FlowRouter.getParam('teamName').split('-').join(' ');\n  }\n\n  Session.set(\"goalReload\", false);\n  Session.set(\"saving\", true);\n  this.userSubscriptionReady = new ReactiveVar(false);\n  this.autorun(() => {\n    this.modalGoalId = FlowRouter.getParam('goalId');\n\n    if (\"undefined\" !== typeof this.modalGoalId && \"\" !== this.modalGoalId) {\n      _hasSubgoalView.set(true);\n\n      _subgoalId.set(FlowRouter.getParam('goalId'));\n\n      $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-sub\", function () {\n        _hasSubgoalView.set(false);\n\n        _subgoalId.set(\"\");\n\n        FlowRouter.go(\"/teamGoals/\" + FlowRouter.getParam('teamName'));\n      });\n      Meteor.setTimeout(function () {\n        $(\"#goal-modal-sub\").modal(\"show\");\n        $(\"#goal-modal-sub\").find(\"div.team-goal\").removeClass(\"collapsed\");\n      }, 1000);\n    }\n\n    this.subscription = this.subscribe('teamGoalsData', this.teamName, {\n      onStop: function () {\n        console.log(\"Team Goals subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Team Goals subscription ready! \", arguments, this);\n      }\n    });\n    this.subscription2 = this.subscribe('userList', Meteor.userId(), {\n      onStop: function () {\n        console.log(\"User List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"User List subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription2);\n  });\n  Meteor.setTimeout(function () {\n    Session.set(\"saving\", false);\n  }, 2000);\n});\nTemplate.team_goals.onRendered(function () {\n  Meteor.setTimeout(function () {\n    $(\"input.date\").datetimepicker({\n      format: 'YYYY-MM-DD',\n      useCurrent: false,\n      showClear: true,\n      showClose: true\n    });\n  }, 1000);\n  $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-new\", function () {\n    $newgoal = $(\"#div-goal-new\").detach();\n    $newgoal.data(\"parent-id\", \"\");\n    $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n  });\n});\n\nvar resetNewGoalForm = () => {\n  let valInputs = [\"goal-title-new\", \"goal-description-new\", \"input-date-due-new\", \"input-date-review-new\", \"input-date-reached-new\"];\n\n  for (let i = 0; i < valInputs.length; i++) {\n    $(\"#\" + valInputs[i]).val(\"\");\n  }\n\n  let slzInputs = [\"select-assigned-to-new\", \"select-mentors-new\", \"select-admins-new\"];\n\n  for (let i = 0; i < valInputs.length; i++) {\n    $(\"#\" + valInputs[i]).val(\"\");\n  }\n};\n\nfunction saveGoal(goalId) {\n  let slAssigned = $(\"#select-assigned-to-\" + goalId)[0].selectize;\n  let slMentors = $(\"#select-mentors-\" + goalId)[0].selectize;\n  let slAdmins = $(\"#select-admins-\" + goalId)[0].selectize;\n  let assignList = slAssigned.getValue();\n  let mentorList = slMentors.getValue();\n  let adminList = slAdmins.getValue();\n  let tplTeamName = $(\"[data-team-name]\").data(\"team-name\");\n  Session.set(\"saving\", true);\n  let saveObj = {\n    teamName: tplTeamName,\n    title: $(\"#goal-title-\" + goalId).val(),\n    description: $(\"#goal-description-\" + goalId).val(),\n    assignedTo: assignList,\n    mentors: mentorList,\n    admins: adminList\n  };\n  let startDate = $(\"#input-start-date-\" + goalId).val();\n\n  if (\"\" !== startDate) {\n    saveObj.startDate = new Date(startDate);\n  }\n\n  let dueDate = $(\"#input-date-due-\" + goalId).val();\n\n  if (\"\" !== dueDate) {\n    saveObj.dueDate = new Date(dueDate);\n  }\n\n  let rvwDate = $(\"#input-date-review-\" + goalId).val();\n\n  if (\"\" !== rvwDate) {\n    saveObj.reviewDate = new Date(rvwDate);\n  }\n\n  if (goalId === BLANK_GOAL._id) {\n    let parentId = $(\"#div-goal-new\").data(\"parent-id\");\n\n    if (\"\" !== parentId) {\n      saveObj.parentId = parentId;\n    }\n\n    Meteor.call('teamgoals.createNewGoal', saveObj, function (err, rslt) {\n      console.log(err, rslt);\n    });\n  } else {\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n    let reviewedOnDate = $(\"#input-date-reviewed-on-\" + goalId).val();\n\n    if (\"\" !== reviewedOnDate) {\n      saveObj.reviewedOnDate = new Date(reviewedOnDate);\n    }\n\n    let reachedDate = $(\"#input-date-reached-\" + goalId).val();\n\n    if (\"\" !== reachedDate) {\n      saveObj.reachedDate = new Date(reachedDate);\n    }\n\n    g.updateFromObj(saveObj);\n  }\n\n  Meteor.setTimeout(function () {\n    Session.set(\"saving\", false);\n  }, 10000);\n}\n\nfunction goalChanged($g) {\n  $g.find(\".btn-save\").prop(\"disabled\", false);\n  $g.find(\".btn-cancel\").prop(\"disabled\", false);\n}\n\nfunction goalUnchanged($g) {\n  $g.find(\".btn-save\").prop(\"disabled\", true);\n  $g.find(\".btn-cancel\").prop(\"disabled\", true);\n  $g.find(\".changed\").removeClass(\"changed\");\n}\n\nTemplate.team_goals.events({\n  'change input.flat,textarea.flat'(event, instance) {\n    $(event.target).addClass('changed');\n    let $goal = $(event.target).closest(\"[data-goal-id]\");\n\n    if ($goal) {\n      if ($(\"#goal-title-\" + $goal.data(\"goal-id\")).val() != \"\") {//\n      }\n    }\n  },\n\n  'change input,textarea,select'(event, instance) {\n    let $t = $(event.target);\n    let $goal = $(event.target).closest(\"[data-goal-id]\");\n    goalChanged($goal);\n  },\n\n  'keyup input,textarea'(event, instance) {\n    let $t = $(event.target);\n    let $goal = $(event.target).closest(\"[data-goal-id]\");\n    goalChanged($goal);\n  },\n\n  'click button.btn-save'(event, instance) {\n    let $t = $(event.target);\n    let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n    saveGoal(goalId);\n    goalUnchanged($(\"#div-goal-\" + goalId));\n    $modalParent = $t.closest(\".modal\");\n\n    if ($modalParent.length) {\n      $modalParent.modal('hide');\n      $newgoal = $(\"#div-goal-new\").detach();\n      $newgoal.data(\"parent-id\", \"\");\n      $(\"#blank-goal\").find(\".col-sm-12\").html($newgoal);\n    }\n\n    if (goalId == BLANK_GOAL._id) {\n      resetNewGoalForm();\n\n      if (!$modalParent.length) {\n        $(\".goal-controls\").show();\n        $(\"#blank-goal\").slideUp();\n      }\n    }\n  },\n\n  'click button.btn-add-subgoal'(event, instance) {\n    let parentId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n    $newgoal = $(\"#div-goal-new\").detach();\n    $newgoal.data(\"parent-id\", parentId);\n    $newgoal.find(\".btn-cancel\").attr(\"disabled\", false);\n    $(\"#goal-modal-new\").find(\".modal-body\").append($newgoal);\n    $(\"#goal-modal-new\").modal(\"show\");\n    $(\"#goal-modal-new\").find(\"div.team-goal\").removeClass(\"collapsed\");\n  },\n\n  'click button.btn-cancel'(event, instance) {\n    let $t = $(event.target);\n    let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n    $modalParent = $t.closest(\".modal\");\n\n    if ($modalParent.length) {\n      $modalParent.modal('hide');\n      $newgoal = $(\"#div-goal-new\").detach();\n      $newgoal.data(\"parent-id\", \"\");\n      $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n    }\n\n    if (goalId == BLANK_GOAL._id) {\n      resetNewGoalForm();\n\n      if (!$modalParent.length) {\n        $(\".goal-controls\").show();\n        $(\"#blank-goal\").slideUp();\n      }\n    } else {\n      //forces a reload from the database\n      Session.set(\"goalReload\", true);\n      Meteor.setTimeout(function () {\n        Session.set(\"goalReload\", false);\n      }, 100);\n    }\n  },\n\n  'click button.btn-comment-add'(event, instance) {\n    $btnAdd = $(event.target);\n    let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n    let $comment = $(\"#new-comment-\" + goalId);\n    let newComment = $comment.val();\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n    g.addComment(newComment);\n    $comment.val(\"\");\n  },\n\n  'click button.btn-review-comment-add'(event, instance) {\n    $btnAdd = $(event.target);\n    let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n    let $comment = $(\"#new-review-comment-\" + goalId);\n    let newComment = $comment.val();\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n    g.addReviewComment(newComment);\n    $comment.val(\"\");\n  },\n\n  'click button#btn-add-goal'(event, instance) {\n    let $btnAdd = $(event.target);\n    $goal = $btnAdd.closest(\"[data-goal-id]\");\n    let goalId = $goal.data(\"goal-id\");\n    $(\".goal-controls\").hide();\n    let $btnCancel = $(\"#blank-goal\").find(\".btn-cancel\");\n    $btnCancel.prop(\"disabled\", false);\n    $(\".team-goal[data-goal-id=\" + goalId + \"]\").removeClass(\"collapsed\");\n    $(\"#blank-goal\").slideDown();\n    $(\"#btn-add-cancel\").fadeIn();\n  },\n\n  'click button#btn-add-cancel'(event, instance) {\n    $(\"#blank-goal\").slideUp();\n    $(\"#btn-add-cancel\").fadeOut();\n  },\n\n  'click button.btn-expand,div.collapsed-summary'(event, instance) {\n    let $target = $(event.target);\n    let $goalContainer = $target.closest(\"[data-goal-id]\");\n    let $targetExpandBtn = $goalContainer.find(\".btn-expand.glyphicon\");\n    $targetExpandBtn.removeClass(\"glyphicon-chevron-up\").addClass(\"glyphicon-chevron-down\");\n\n    if ($goalContainer.hasClass(\"collapsed\")) {\n      $(\".team-goal[data-goal-id]:not(.collapsed)\").slideUp(function () {\n        $(this).addClass(\"collapsed\").css(\"display\", \"block\");\n      });\n      $goalContainer.css(\"display\", \"none\").removeClass(\"collapsed\").slideDown(function () {\n        $('html, body').animate({\n          scrollTop: $goalContainer.offset().top\n        }, 500);\n      });\n      $targetExpandBtn.removeClass(\"glyphicon-chevron-down\");\n      $targetExpandBtn.addClass(\"glyphicon-chevron-up\");\n    } else {\n      $goalContainer.slideUp(function () {\n        $goalContainer.addClass(\"collapsed\").css(\"display\", \"block\");\n      });\n      $targetExpandBtn.removeClass(\"glyphicon-chevron-up\");\n      $targetExpandBtn.addClass(\"glyphicon-chevron-down\");\n    }\n  },\n\n  'keyup textarea.goal-description,input.goal-title': _.debounce(function (event, instance) {\n    let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n\n    if (\"new\" === goalId) {\n      //don't auto-save if creating a new goal\n      return;\n    }\n\n    saveGoal(goalId);\n    goalUnchanged($(\"#div-goal-\" + goalId));\n  }, 2000),\n  'change input,select': _.debounce(function (event, instance) {\n    if (!Session.get(\"saving\")) {\n      let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n\n      if (\"new\" === goalId) {\n        //don't auto-save if creating a new goal\n        return;\n      }\n\n      saveGoal(goalId);\n      goalUnchanged($(\"#div-goal-\" + goalId));\n    }\n  }, 2000),\n  'dp.change': _.debounce(function (event, instance) {\n    if (!Session.get(\"saving\")) {\n      let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n\n      if (\"new\" === goalId) {\n        //don't auto-save if creating a new goal\n        return;\n      }\n\n      saveGoal(goalId);\n      goalUnchanged($(\"#div-goal-\" + goalId));\n    }\n  }, 2000),\n\n  'click div.team-goal-title[data-id]'(event, instance) {\n    if (!Session.get(\"saving\")) {\n      _hasSubgoalView.set(true);\n\n      let gid = $(event.target).data(\"id\");\n\n      _subgoalId.set(gid);\n\n      FlowRouter.go(\"/teamGoals/\" + FlowRouter.getParam('teamName') + \"/\" + gid);\n      $(\"#goal-modal-sub\").prop(\"disabled\", false).modal(\"show\");\n    }\n  }\n\n});\n\nfunction getTeamName() {\n  let teamName = Template.instance().teamName;\n  return teamName;\n}\n\nTemplate.team_goals.helpers({\n  goalReload() {\n    return Session.get(\"goalReload\");\n  },\n\n  hasGoals() {\n    let teamName = getTeamName();\n    let g = TeamGoal.find({\n      teamName: teamName,\n      parentId: '',\n      reachedDate: null\n    }).fetch();\n    return g.length > 0;\n  },\n\n  hasReachedGoals() {\n    let teamName = getTeamName();\n    let g = TeamGoal.find({\n      teamName: teamName,\n      parentId: '',\n      reachedDate: {\n        $ne: null\n      }\n    }).fetch();\n    return g.length > 0;\n  },\n\n  teamGoals() {\n    let teamName = getTeamName();\n    let g = TeamGoal.find({\n      teamName: teamName,\n      parentId: '',\n      reachedDate: null\n    }).fetch();\n    return g;\n  },\n\n  teamReachedGoals() {\n    let teamName = getTeamName();\n    let g = TeamGoal.find({\n      teamName: teamName,\n      parentId: '',\n      reachedDate: {\n        $ne: null\n      }\n    }).fetch();\n    return g;\n  },\n\n  blankGoal() {\n    return Object.assign({\n      teamName: Template.instance().teamName\n    }, BLANK_GOAL);\n  },\n\n  hasSubgoalView() {\n    let hasView = _hasSubgoalView.get();\n\n    let gid = _subgoalId.get();\n\n    if (hasView) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  subgoal() {\n    let hasView = _hasSubgoalView.get();\n\n    let subgoalId = Template.instance().modalGoalId;\n    subgoalId = _subgoalId.get();\n    let g = TeamGoal.findOne({\n      _id: subgoalId\n    });\n\n    if (g) {\n      return g;\n    } else {\n      return {};\n    }\n  },\n\n  team() {\n    return getTeamName();\n  },\n\n  teamSlug() {\n    return getTeamName().split(\" \").join(\"-\");\n  },\n\n  goalComments(goalId) {\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.goalComments;\n    return c;\n  },\n\n  reviewComments(goalId) {\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.reviewComments;\n    return c;\n  },\n\n  formatDate(dateObj) {\n    return dateObj.toLocaleDateString();\n  },\n\n  getUserName(userId) {\n    let u = User.findOne({\n      _id: userId\n    });\n    if (!u) return \"\";\n    let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n    return fullName;\n  },\n\n  userList() {\n    let list = [{\n      id: 1,\n      name: \"George\"\n    }, {\n      id: 2,\n      name: \"Frank\"\n    }];\n    return list;\n  }\n\n});\nTemplate.goal_view.onRendered(function () {});\nTemplate.goal_view.helpers({\n  childGoals() {\n    let goalId = Template.instance().data.goal._id;\n\n    let children = TeamGoal.find({\n      parentId: goalId\n    }).fetch();\n    return children;\n  },\n\n  hasChildren() {\n    let goalId = Template.instance().data.goal._id;\n\n    let doesHave = TeamGoal.find({\n      parentId: goalId\n    }).fetch().length > 0;\n    return doesHave;\n  },\n\n  goalComments(goalId) {\n    if (goalId === BLANK_GOAL._id) {\n      return;\n    }\n\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.goalComments;\n    return c;\n  },\n\n  reviewComments(goalId) {\n    if (goalId === BLANK_GOAL._id) {\n      return;\n    }\n\n    let g = TeamGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.reviewComments;\n    return c;\n  },\n\n  formatDate(dateObj) {\n    return dateObj.toLocaleDateString();\n  },\n\n  dateField(fld) {\n    let goal = Template.instance().data.goal;\n\n    if (goal._id == BLANK_GOAL._id) {\n      return \"\";\n    }\n\n    let d = goal[fld];\n\n    if (!(d instanceof Date)) {\n      return \"\";\n    }\n\n    let dateText = new Date(d.getTime() - d.getTimezoneOffset() * 60000).toISOString().slice(0, -1);\n    return dateText;\n  },\n\n  getUserName(userId) {\n    let u = User.findOne({\n      _id: userId\n    });\n    if (!u) return \"\";\n    let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n    return fullName;\n  },\n\n  userList() {\n    let userList = [];\n    let teamRole = {};\n    teamRole[\"roles.\" + Template.instance().data.goal.teamName] = \"member\";\n    User.find(teamRole).forEach(user => {\n      userList.push({\n        text: user.MyProfile.firstName + \" \" + user.MyProfile.lastName,\n        value: user._id\n      });\n    });\n    console.log(teamRole, userList);\n    return userList;\n  },\n\n  progressPct() {\n    let goal = Template.instance().data.goal;\n    let g = TeamGoal.findOne({\n      _id: goal._id\n    });\n    if (!g) return 0;\n\n    if (!g.dueDate || !g.startDate || \"undefined\" === typeof g.dueDate || \"undefined\" === typeof g.startDate) {\n      return 0;\n    }\n\n    let currDt = new Date().getTime();\n    let totalDuration = g.dueDate.getTime() - g.startDate.getTime();\n    let timeSinceStart = currDt - g.startDate.getTime();\n    let pct = timeSinceStart / totalDuration;\n    return Math.min(parseInt(pct * 100), 100);\n  },\n\n  userHasModifyPerm(fld) {\n    let goal = Template.instance().data.goal;\n    let g = TeamGoal.findOne({\n      _id: goal._id\n    });\n    if (!g) return true;\n    return g.hasModifyPerm(fld);\n  },\n\n  fldEnabled(fld) {\n    let goal = Template.instance().data.goal;\n    let g = TeamGoal.findOne({\n      _id: goal._id\n    });\n\n    if (!g) {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin', goal.teamName)) {\n        return \"\";\n      } else {\n        return \"disabled\";\n      }\n    }\n\n    if (g.hasModifyPerm(fld)) {\n      return \"\";\n    } else {\n      return \"disabled\";\n    }\n  },\n\n  commaListUsers(lst) {\n    var nameList = [];\n    let goal = Template.instance().data.goal;\n    let g = TeamGoal.findOne({\n      _id: goal._id\n    });\n\n    for (let i = 0; i < lst.length; i++) {\n      let u = User.findOne({\n        _id: lst[i]\n      });\n      nameList.push(u.MyProfile.firstName + \" \" + u.MyProfile.lastName);\n    }\n\n    return nameList.join(', ');\n  },\n\n  isNew(id) {\n    return BLANK_GOAL._id === id;\n  },\n\n  collapsed(pid) {\n    //if this goal has a parent it is being displayed in a modal and should not be collapsed\n    if (\"\" !== pid) {\n      return \"\";\n    } else {\n      return \"collapsed\";\n    }\n  }\n\n});\nTemplate.child_goal_view.helpers({\n  childGoals() {\n    let goalId = Template.instance().data.goal._id;\n\n    let children = TeamGoal.find({\n      parentId: goalId\n    }).fetch();\n    return children;\n  },\n\n  hasChildren(goalId) {\n    goalId = Template.instance().data.goal._id;\n    let doesHave = TeamGoal.find({\n      parentId: goalId\n    }).count() > 0;\n    return doesHave;\n  }\n\n});","map":{"version":3,"sources":["imports/ui/pages/team_goals/team_goals.js"],"names":["Meteor","module","watch","require","v","User","TeamGoal","BLANK_GOAL","_id","title","description","_hasSubgoalView","ReactiveVar","_subgoalId","Template","team_goals","onCreated","data","teamName","FlowRouter","getParam","split","join","Session","set","userSubscriptionReady","autorun","modalGoalId","$","on","go","setTimeout","modal","find","removeClass","subscription","subscribe","onStop","console","log","arguments","onReady","subscription2","userId","onRendered","datetimepicker","format","useCurrent","showClear","showClose","$newgoal","detach","append","resetNewGoalForm","valInputs","i","length","val","slzInputs","saveGoal","goalId","slAssigned","selectize","slMentors","slAdmins","assignList","getValue","mentorList","adminList","tplTeamName","saveObj","assignedTo","mentors","admins","startDate","Date","dueDate","rvwDate","reviewDate","parentId","call","err","rslt","g","findOne","reviewedOnDate","reachedDate","updateFromObj","goalChanged","$g","prop","goalUnchanged","events","event","instance","target","addClass","$goal","closest","$t","$modalParent","html","show","slideUp","attr","$btnAdd","$comment","newComment","addComment","addReviewComment","hide","$btnCancel","slideDown","fadeIn","fadeOut","$target","$goalContainer","$targetExpandBtn","hasClass","css","animate","scrollTop","offset","top","_","debounce","get","gid","getTeamName","helpers","goalReload","hasGoals","fetch","hasReachedGoals","$ne","teamGoals","teamReachedGoals","blankGoal","Object","assign","hasSubgoalView","hasView","subgoal","subgoalId","team","teamSlug","goalComments","c","reviewComments","formatDate","dateObj","toLocaleDateString","getUserName","u","fullName","MyProfile","firstName","lastName","userList","list","id","name","goal_view","childGoals","goal","children","hasChildren","doesHave","dateField","fld","d","dateText","getTime","getTimezoneOffset","toISOString","slice","teamRole","forEach","user","push","text","value","progressPct","currDt","totalDuration","timeSinceStart","pct","Math","min","parseInt","userHasModifyPerm","hasModifyPerm","fldEnabled","Roles","userIsInRole","commaListUsers","lst","nameList","isNew","collapsed","pid","child_goal_view","count"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { User } from '/imports/api/users/users.js';\nimport { TeamGoal } from '/imports/api/team_goals/team_goals.js';\nimport './team_goals.html';\nimport '/imports/ui/components/select_autocomplete/select_autocomplete.js';\n\nconst BLANK_GOAL = {\n    _id: \"new\",\n    title: \"\",\n    description: \"\"\n};\n\nlet _hasSubgoalView = new ReactiveVar(false);\nlet _subgoalId = new ReactiveVar(\"\");\nTemplate.team_goals.onCreated(function () {\n    if (this.data.teamName) {\n        this.teamName = this.data.teamName;\n    } else {\n        this.teamName = FlowRouter.getParam('teamName').split('-').join(' ');\n    }\n\n    Session.set(\"goalReload\",false);\n    Session.set(\"saving\",true);\n\n    this.userSubscriptionReady = new ReactiveVar( false );\n    this.autorun( () => {\n        this.modalGoalId = FlowRouter.getParam('goalId');\n        if (\"undefined\" !== typeof this.modalGoalId && \"\" !== this.modalGoalId) {\n            _hasSubgoalView.set(true);\n            _subgoalId.set(FlowRouter.getParam('goalId'));\n            $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-sub\", function () {\n                _hasSubgoalView.set(false);\n                _subgoalId.set(\"\");\n                FlowRouter.go(\"/teamGoals/\"+FlowRouter.getParam('teamName'));\n            });\n            Meteor.setTimeout(function () {\n                $(\"#goal-modal-sub\").modal(\"show\");\n                $(\"#goal-modal-sub\").find(\"div.team-goal\").removeClass(\"collapsed\");\n            }, 1000);\n        }\n        this.subscription = this.subscribe('teamGoalsData', this.teamName, {\n            onStop: function () {\n                console.log(\"Team Goals subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"Team Goals subscription ready! \", arguments, this);\n            }\n        });\n        this.subscription2 = this.subscribe('userList', Meteor.userId(), {\n            onStop: function () {\n                console.log(\"User List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"User List subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription2);\n    });\n    Meteor.setTimeout(function () {\n        Session.set(\"saving\",false);\n    }, 2000);\n});\nTemplate.team_goals.onRendered(function () {\n    Meteor.setTimeout(function() {\n        $(\"input.date\").datetimepicker({\n            format:'YYYY-MM-DD',\n            useCurrent:false,\n            showClear:true,\n            showClose:true\n        });\n    }, 1000);\n    $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-new\", function () {\n        $newgoal = $(\"#div-goal-new\").detach();\n        $newgoal.data(\"parent-id\",\"\");\n        $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n    });\n});\n\nvar resetNewGoalForm = () => {\n    let valInputs = [\n        \"goal-title-new\",\n        \"goal-description-new\",\n        \"input-date-due-new\",\n        \"input-date-review-new\",\n        \"input-date-reached-new\",\n    ];\n    for (let i = 0; i < valInputs.length; i++) {\n        $(\"#\"+valInputs[i]).val(\"\");\n    }\n\n    let slzInputs = [\n        \"select-assigned-to-new\",\n        \"select-mentors-new\",\n        \"select-admins-new\"\n    ];\n    for (let i = 0; i < valInputs.length; i++) {\n        $(\"#\"+valInputs[i]).val(\"\");\n    }\n};\n\nfunction saveGoal(goalId) {\n    let slAssigned = $(\"#select-assigned-to-\"+goalId)[0].selectize;\n    let slMentors = $(\"#select-mentors-\"+goalId)[0].selectize;\n    let slAdmins = $(\"#select-admins-\"+goalId)[0].selectize;\n    let assignList = slAssigned.getValue();\n    let mentorList = slMentors.getValue();\n    let adminList = slAdmins.getValue();\n    let tplTeamName = $(\"[data-team-name]\").data(\"team-name\");\n\n    Session.set(\"saving\",true);\n    let saveObj = {\n        teamName: tplTeamName,\n        title: $(\"#goal-title-\"+goalId).val(),\n        description: $(\"#goal-description-\"+goalId).val(),\n        assignedTo: assignList,\n        mentors: mentorList,\n        admins: adminList\n    };\n    let startDate = $(\"#input-start-date-\"+goalId).val();\n    if (\"\" !== startDate) {\n        saveObj.startDate = new Date(startDate);\n    }\n    let dueDate = $(\"#input-date-due-\"+goalId).val();\n    if (\"\" !== dueDate) {\n        saveObj.dueDate = new Date(dueDate);\n    }\n    let rvwDate = $(\"#input-date-review-\"+goalId).val();\n    if (\"\" !== rvwDate) {\n        saveObj.reviewDate = new Date(rvwDate);\n    }\n\n    if (goalId === BLANK_GOAL._id) {\n        let parentId = $(\"#div-goal-new\").data(\"parent-id\");\n        if (\"\" !== parentId) {\n            saveObj.parentId = parentId;\n        }\n        Meteor.call('teamgoals.createNewGoal', saveObj, function (err, rslt) {\n            console.log(err, rslt);\n        });\n    } else {\n        let g = TeamGoal.findOne( {_id: goalId} );\n        let reviewedOnDate = $(\"#input-date-reviewed-on-\"+goalId).val();\n        if (\"\" !== reviewedOnDate) {\n            saveObj.reviewedOnDate = new Date(reviewedOnDate);\n        }\n        let reachedDate = $(\"#input-date-reached-\"+goalId).val();\n        if (\"\" !== reachedDate) {\n            saveObj.reachedDate = new Date(reachedDate);\n        }\n\n        g.updateFromObj(saveObj);\n    }\n    Meteor.setTimeout(function () {\n        Session.set(\"saving\",false);\n    }, 10000);\n}\n\nfunction goalChanged($g) {\n    $g.find(\".btn-save\").prop(\"disabled\",false);\n    $g.find(\".btn-cancel\").prop(\"disabled\",false);\n}\nfunction goalUnchanged($g) {\n    $g.find(\".btn-save\").prop(\"disabled\",true);\n    $g.find(\".btn-cancel\").prop(\"disabled\",true);\n    $g.find(\".changed\").removeClass(\"changed\");\n}\n\nTemplate.team_goals.events({\n    'change input.flat,textarea.flat'(event, instance) {\n        $(event.target).addClass('changed');\n        let $goal = $(event.target).closest(\"[data-goal-id]\");\n        if ($goal) {\n            if ($(\"#goal-title-\"+$goal.data(\"goal-id\")).val() != \"\") {\n                //\n            }\n        }\n    },\n    'change input,textarea,select'(event, instance) {\n        let $t = $(event.target);\n        let $goal = $(event.target).closest(\"[data-goal-id]\");\n        goalChanged($goal);\n    },\n    'keyup input,textarea'(event, instance) {\n        let $t = $(event.target);\n        let $goal = $(event.target).closest(\"[data-goal-id]\");\n        goalChanged($goal);\n    },\n    'click button.btn-save'(event, instance) {\n        let $t = $(event.target);\n        let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n        saveGoal(goalId);\n        goalUnchanged($(\"#div-goal-\"+goalId));\n\n        $modalParent = $t.closest(\".modal\");\n        if ($modalParent.length) {\n            $modalParent.modal('hide');\n            $newgoal = $(\"#div-goal-new\").detach();\n            $newgoal.data(\"parent-id\",\"\");\n            $(\"#blank-goal\").find(\".col-sm-12\").html($newgoal);\n        }\n        if (goalId == BLANK_GOAL._id) {\n            resetNewGoalForm();\n            if ( ! $modalParent.length ) {\n                $(\".goal-controls\").show();\n                $(\"#blank-goal\").slideUp();\n            }\n        }\n    },\n    'click button.btn-add-subgoal'(event, instance) {\n        let parentId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n        $newgoal = $(\"#div-goal-new\").detach();\n        $newgoal.data(\"parent-id\",parentId);\n        $newgoal.find(\".btn-cancel\").attr(\"disabled\",false);\n        $(\"#goal-modal-new\").find(\".modal-body\").append($newgoal);\n        $(\"#goal-modal-new\").modal(\"show\");\n        $(\"#goal-modal-new\").find(\"div.team-goal\").removeClass(\"collapsed\");\n    },\n    'click button.btn-cancel'(event, instance) {\n        let $t = $(event.target);\n        let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n\n        $modalParent = $t.closest(\".modal\");\n        if ($modalParent.length) {\n            $modalParent.modal('hide');\n            $newgoal = $(\"#div-goal-new\").detach();\n            $newgoal.data(\"parent-id\",\"\");\n            $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n        }\n\n        if (goalId == BLANK_GOAL._id) {\n            resetNewGoalForm();\n            if ( ! $modalParent.length ) {\n                $(\".goal-controls\").show();\n                $(\"#blank-goal\").slideUp();\n            }\n        } else {\n            //forces a reload from the database\n            Session.set(\"goalReload\",true);\n            Meteor.setTimeout(function () {\n                Session.set(\"goalReload\",false);\n            }, 100);\n        }\n    },\n    'click button.btn-comment-add'(event, instance) {\n        $btnAdd = $(event.target);\n\n        let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n        let $comment = $(\"#new-comment-\"+goalId);\n        let newComment = $comment.val();\n        let g = TeamGoal.findOne( {_id: goalId} );\n        g.addComment(newComment);\n        $comment.val(\"\");\n    },\n    'click button.btn-review-comment-add'(event, instance) {\n        $btnAdd = $(event.target);\n\n        let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n        let $comment = $(\"#new-review-comment-\"+goalId);\n        let newComment = $comment.val();\n        let g = TeamGoal.findOne( {_id: goalId} );\n        g.addReviewComment(newComment);\n        $comment.val(\"\");\n    },\n    'click button#btn-add-goal'(event, instance) {\n        let $btnAdd = $(event.target);\n        $goal = $btnAdd.closest(\"[data-goal-id]\")\n        let goalId = $goal.data(\"goal-id\");\n\n        $(\".goal-controls\").hide();\n        let $btnCancel = $(\"#blank-goal\").find(\".btn-cancel\")\n        $btnCancel.prop(\"disabled\",false);\n        $(\".team-goal[data-goal-id=\"+goalId+\"]\").removeClass(\"collapsed\");\n        $(\"#blank-goal\").slideDown();\n        $(\"#btn-add-cancel\").fadeIn();\n    },\n    'click button#btn-add-cancel'(event, instance) {\n        $(\"#blank-goal\").slideUp();\n        $(\"#btn-add-cancel\").fadeOut();\n    },\n    'click button.btn-expand,div.collapsed-summary'(event, instance) {\n        let $target = $(event.target);\n        let $goalContainer = $target.closest(\"[data-goal-id]\");\n        let $targetExpandBtn = $goalContainer.find(\".btn-expand.glyphicon\");\n\n        $targetExpandBtn.removeClass(\"glyphicon-chevron-up\")\n            .addClass(\"glyphicon-chevron-down\");\n\n        if ($goalContainer.hasClass(\"collapsed\")) {\n            $(\".team-goal[data-goal-id]:not(.collapsed)\").slideUp(function() {\n                $(this).addClass(\"collapsed\").css(\"display\",\"block\");\n            });\n            $goalContainer.css(\"display\",\"none\").removeClass(\"collapsed\").slideDown(function () {\n                $('html, body').animate({\n                    scrollTop: ($goalContainer.offset().top)\n                },500);\n            });\n            $targetExpandBtn.removeClass(\"glyphicon-chevron-down\");\n            $targetExpandBtn.addClass(\"glyphicon-chevron-up\");\n        } else {\n            $goalContainer.slideUp(function() {\n                $goalContainer.addClass(\"collapsed\").css(\"display\",\"block\");\n            });\n            $targetExpandBtn.removeClass(\"glyphicon-chevron-up\");\n            $targetExpandBtn.addClass(\"glyphicon-chevron-down\");\n        }\n    },\n    'keyup textarea.goal-description,input.goal-title':_.debounce(function (event, instance) {\n        let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n        if (\"new\" === goalId) {\n            //don't auto-save if creating a new goal\n            return;\n        }\n        saveGoal(goalId);\n        goalUnchanged($(\"#div-goal-\"+goalId));\n    }, 2000),\n    'change input,select':_.debounce(function (event, instance) {\n        if (!Session.get(\"saving\")) {\n            let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n            if (\"new\" === goalId) {\n                //don't auto-save if creating a new goal\n                return;\n            }\n            saveGoal(goalId);\n            goalUnchanged($(\"#div-goal-\"+goalId));\n        }\n    }, 2000),\n    'dp.change':_.debounce(function (event, instance) {\n        if (!Session.get(\"saving\")) {\n            let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n            if (\"new\" === goalId) {\n                //don't auto-save if creating a new goal\n                return;\n            }\n            saveGoal(goalId);\n            goalUnchanged($(\"#div-goal-\"+goalId));\n        }\n    }, 2000),\n    'click div.team-goal-title[data-id]'(event, instance) {\n        if (!Session.get(\"saving\")) {\n            _hasSubgoalView.set(true);\n            let gid = $(event.target).data(\"id\");\n            _subgoalId.set(gid);\n            FlowRouter.go(\"/teamGoals/\"+FlowRouter.getParam('teamName')+\"/\"+gid);\n            $(\"#goal-modal-sub\").prop(\"disabled\",false).modal(\"show\");\n        }\n    }\n});\n\nfunction getTeamName() {\n    let teamName = Template.instance().teamName;\n    return teamName;\n}\nTemplate.team_goals.helpers({\n    goalReload() {\n        return Session.get(\"goalReload\");\n    },\n    hasGoals() {\n        let teamName = getTeamName();\n        let g = TeamGoal.find( {teamName: teamName, parentId: '', reachedDate: null} ).fetch();\n        return g.length > 0;\n    },\n    hasReachedGoals() {\n        let teamName = getTeamName();\n        let g = TeamGoal.find( {teamName: teamName, parentId: '', reachedDate: {$ne:null}} ).fetch();\n        return g.length > 0;\n    },\n    teamGoals() {\n        let teamName = getTeamName();\n        let g = TeamGoal.find( {teamName: teamName, parentId: '', reachedDate: null} ).fetch();\n        return g;\n    },\n    teamReachedGoals() {\n        let teamName = getTeamName();\n        let g = TeamGoal.find( {teamName: teamName, parentId: '', reachedDate: {$ne:null}} ).fetch();\n        return g;\n    },\n    blankGoal() {\n        return Object.assign({teamName: Template.instance().teamName}, BLANK_GOAL);\n    },\n    hasSubgoalView() {\n        let hasView = _hasSubgoalView.get();\n        let gid = _subgoalId.get();\n        if (hasView) {\n            return true;\n        } else {\n            return false;\n        }\n    },\n    subgoal() {\n        let hasView = _hasSubgoalView.get();\n        let subgoalId = Template.instance().modalGoalId;\n        subgoalId = _subgoalId.get();\n        let g = TeamGoal.findOne( {_id: subgoalId} );\n        if (g) {\n            return g;\n        } else {\n            return {};\n        }\n    },\n    team() {\n        return getTeamName();\n    },\n    teamSlug() {\n        return getTeamName().split(\" \").join(\"-\");\n    },\n    goalComments(goalId) {\n        let g = TeamGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.goalComments;\n        return c;\n    },\n    reviewComments(goalId) {\n        let g = TeamGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.reviewComments;\n        return c;\n    },\n    formatDate(dateObj) {\n        return dateObj.toLocaleDateString();\n    },\n    getUserName(userId) {\n        let u = User.findOne( {_id: userId} );\n        if (!u) return \"\";\n        let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n        return fullName;\n    },\n    userList() {\n        let list = [\n            {id: 1, name: \"George\"},\n            {id: 2, name: \"Frank\"}\n        ];\n        return list;\n    }\n});\n\nTemplate.goal_view.onRendered(function () {\n});\n\nTemplate.goal_view.helpers({\n    childGoals() {\n        let goalId = Template.instance().data.goal._id;\n        let children = TeamGoal.find( {parentId: goalId} ).fetch();\n        return children;\n    },\n    hasChildren() {\n        let goalId = Template.instance().data.goal._id;\n        let doesHave = TeamGoal.find( {parentId: goalId} ).fetch().length > 0;\n        return doesHave;\n    },\n    goalComments(goalId) {\n        if (goalId === BLANK_GOAL._id) {\n            return;\n        }\n        let g = TeamGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.goalComments;\n        return c;\n    },\n    reviewComments(goalId) {\n        if (goalId === BLANK_GOAL._id) {\n            return;\n        }\n        let g = TeamGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.reviewComments;\n        return c;\n    },\n    formatDate(dateObj) {\n        return dateObj.toLocaleDateString();\n    },\n    dateField(fld) {\n        let goal = Template.instance().data.goal;\n        if (goal._id == BLANK_GOAL._id) {\n            return \"\";\n        }\n        let d = goal[fld];\n        if ( !(d instanceof Date) ) {\n            return \"\";\n        }\n        let dateText = new Date(d.getTime() - d.getTimezoneOffset()*60000).toISOString().slice(0,-1);\n        return dateText;\n    },\n    getUserName(userId) {\n        let u = User.findOne( {_id: userId} );\n        if (!u) return \"\";\n        let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n        return fullName;\n    },\n    userList() {\n        let userList = [];\n        let teamRole = {};\n        teamRole[\"roles.\"+Template.instance().data.goal.teamName] = \"member\";\n        User.find( teamRole ).forEach( (user) => {\n            userList.push({\n                text: user.MyProfile.firstName + \" \" + user.MyProfile.lastName,\n                value: user._id\n            })\n        });\n        console.log(teamRole, userList);\n        return userList;\n    },\n    progressPct() {\n        let goal = Template.instance().data.goal;\n        let g = TeamGoal.findOne( {_id: goal._id} );\n        if (!g) return 0;\n\n        if (!g.dueDate || !g.startDate || \"undefined\" === typeof g.dueDate || \"undefined\" === typeof g.startDate) {\n            return 0;\n        }\n        let currDt = new Date().getTime();\n        let totalDuration = g.dueDate.getTime() - g.startDate.getTime();\n        let timeSinceStart = currDt - g.startDate.getTime();\n        let pct = (timeSinceStart / totalDuration);\n        return Math.min(parseInt(pct*100),100);\n    },\n    userHasModifyPerm(fld) {\n        let goal = Template.instance().data.goal;\n        let g = TeamGoal.findOne( {_id: goal._id} );\n        if (!g) return true;\n        return g.hasModifyPerm(fld);\n    },\n    fldEnabled(fld) {\n        let goal = Template.instance().data.goal;\n        let g = TeamGoal.findOne( {_id: goal._id} );\n\n        if (!g) {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin', goal.teamName)) {\n                return \"\";\n            } else {\n                return \"disabled\";\n            }\n        }\n\n        if (g.hasModifyPerm(fld)) {\n            return \"\";\n        } else {\n            return \"disabled\";\n        }\n    },\n    commaListUsers(lst) {\n        var nameList = [];\n\n        let goal = Template.instance().data.goal;\n        let g = TeamGoal.findOne( {_id: goal._id} );\n\n        for (let i = 0; i < lst.length; i++) {\n            let u = User.findOne( {_id: lst[i]} );\n            nameList.push(u.MyProfile.firstName + \" \" + u.MyProfile.lastName);\n        }\n        return nameList.join(', ');\n    },\n    isNew(id) {\n        return BLANK_GOAL._id === id;\n    },\n    collapsed(pid) {\n        //if this goal has a parent it is being displayed in a modal and should not be collapsed\n        if (\"\" !== pid) {\n            return \"\";\n        } else {\n            return \"collapsed\";\n        }\n    }\n})\nTemplate.child_goal_view.helpers({\n    childGoals() {\n        let goalId = Template.instance().data.goal._id;\n        let children = TeamGoal.find( {parentId: goalId} ).fetch();\n        return children;\n    },\n    hasChildren(goalId) {\n        goalId = Template.instance().data.goal._id;\n        let doesHave = TeamGoal.find( {parentId: goalId} ).count() > 0;\n        return doesHave;\n    }\n});\n"]},"sourceType":"script","hash":"1d0556c40cfccd8480dc44bdf275643268ca220b"}
