{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":false}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"FunctionExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$5","visitor":{"ForInStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$6","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"ArrowFunctionExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"BlockStatement":{"enter":[null]},"SwitchCase":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$4","visitor":{"VariableDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"_exploded":true,"BlockStatement":{"enter":[null]},"SwitchStatement":{"enter":[null]},"Program":{"enter":[null]},"_verified":true,"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$5","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$6","visitor":{"ObjectExpression":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$7","visitor":{"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"VariableDeclaration":{"enter":[null]},"_exploded":true,"_verified":true,"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$9","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"ObjectExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$11","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$12","visitor":{"ObjectMethod":{"enter":[null]},"ObjectProperty":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$13","visitor":{"ArrayExpression":{"enter":[null]},"CallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$14","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$15","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$16","visitor":{"UnaryExpression":{"enter":[null]},"_exploded":true,"_verified":true,"BlockStatement":{"enter":[null]},"CatchClause":{"enter":[null]},"DoWhileStatement":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForStatement":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"Program":{"enter":[null]},"ObjectMethod":{"enter":[null]},"SwitchStatement":{"enter":[null]},"WhileStatement":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"ForOfStatement":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$17","visitor":{"RegExpLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$18","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$19","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$20","visitor":{"ObjectProperty":{"exit":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$21","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$22","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$23","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}},{"key":"regenerator-transform","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"exit":[null]},"FunctionExpression":{"exit":[null]},"ObjectMethod":{"exit":[null]},"ArrowFunctionExpression":{"exit":[null]},"ClassMethod":{"exit":[null]}},"options":{}}],"presets":[],"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan\\imports\\api\\user_notify\\user_notify.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining","pipelineOperator","throwExpressions","dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"imports/api/user_notify/user_notify.js","filename":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan\\imports\\api\\user_notify\\user_notify.js","passPerPreset":false,"envName":"development","cwd":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan","root":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan","generatorOpts":{"filename":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan\\imports\\api\\user_notify\\user_notify.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/api/user_notify/user_notify.js"}},"code":"module.export({\n  UserNotify: function () {\n    return UserNotify;\n  }\n});\nvar Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor: function (v) {\n    Meteor = v;\n  }\n}, 0);\nvar Mongo;\nmodule.watch(require(\"meteor/mongo\"), {\n  Mongo: function (v) {\n    Mongo = v;\n  }\n}, 1);\nvar Class, Enum;\nmodule.watch(require(\"meteor/jagi:astronomy\"), {\n  Class: function (v) {\n    Class = v;\n  },\n  Enum: function (v) {\n    Enum = v;\n  }\n}, 2);\nvar User;\nmodule.watch(require(\"../users/users.js\"), {\n  User: function (v) {\n    User = v;\n  }\n}, 3);\nvar Email;\nmodule.watch(require(\"meteor/email\"), {\n  Email: function (v) {\n    Email = v;\n  }\n}, 4);\nvar UserNotify = Class.create({\n  name: \"UserNotify\",\n  collection: new Mongo.Collection('user_notify'),\n  fields: {\n    userId: {\n      type: String,\n      \"default\": ''\n    },\n    isRead: {\n      type: Boolean,\n      \"default\": false\n    },\n    isPushed: {\n      type: Boolean,\n      \"default\": false\n    },\n    isEmailed: {\n      type: Boolean,\n      \"default\": false\n    },\n    title: {\n      type: String,\n      \"default\": ''\n    },\n    body: {\n      type: String,\n      \"default\": ''\n    },\n    action: {\n      type: String,\n      \"default\": ''\n    },\n    createdDate: {\n      type: Date,\n      \"default\": function () {\n        return new Date();\n      }\n    }\n  },\n  meteorMethods: {\n    markRead: function () {\n      this.isRead = true;\n      this.save();\n    },\n    markNotified: function () {\n      this.isPushed = true;\n      this.save();\n    }\n  },\n  helpers: {\n    test: function () {\n      console.log(\"123\");\n    },\n    pushNotify: function (opts) {\n      var noteOpts = {\n        body: this.body,\n        icon: '/img/panda.png',\n        data: this._id\n      };\n      var browserNote;\n\n      if (!(\"Notification\" in window)) {\n        alert(\"This browser does not support desktop notification\");\n      } // Let's check whether notification permissions have already been granted\n      else if (Notification.permission === \"granted\") {\n          // If it's okay let's create a notification\n          browserNote = new Notification(this.title, noteOpts);\n        } // Otherwise, we need to ask the user for permission\n        else if (Notification.permission !== \"denied\") {\n            Notification.requestPermission(function (permission) {\n              // If the user accepts, let's create a notification\n              if (permission === \"granted\") {\n                browserNote = new Notification(this.title, noteOpts);\n              }\n            });\n          }\n\n      if (Notification.permission === \"granted\" && typeof opts.onclick !== 'undefined') {\n        browserNote.onclick = opts.onclick;\n      }\n    }\n  },\n  events: {\n    beforeSave: function (e) {\n      if (Meteor.isServer) {\n        var note = e.currentTarget;\n\n        if (!note.isEmailed) {\n          var u = User.findOne({\n            _id: note.userId\n          });\n\n          if (u) {\n            var addr = u.emails[0].address;\n            Email.send({\n              to: addr,\n              from: \"wayne@paladinarcher.com\",\n              subject: \"Developer Level Notification - \" + note.title,\n              text: note.body\n            });\n          }\n        }\n      }\n    }\n  }\n});\n\nif (Meteor.isClient) {//\n}\n\nUserNotify.add = function (opts) {\n  var notify = new UserNotify(opts);\n  notify.save();\n};","map":{"version":3,"sources":["imports/api/user_notify/user_notify.js"],"names":["module","export","UserNotify","Meteor","watch","require","v","Mongo","Class","Enum","User","Email","create","name","collection","Collection","fields","userId","type","String","isRead","Boolean","isPushed","isEmailed","title","body","action","createdDate","Date","meteorMethods","markRead","save","markNotified","helpers","test","console","log","pushNotify","opts","noteOpts","icon","data","_id","browserNote","window","alert","Notification","permission","requestPermission","onclick","events","beforeSave","e","isServer","note","currentTarget","u","findOne","addr","emails","address","send","to","from","subject","text","isClient","add","notify"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { Mongo } from 'meteor/mongo';\nimport { Class, Enum } from 'meteor/jagi:astronomy';\nimport { User } from '../users/users.js';\nimport { Email } from 'meteor/email';\n\nlet UserNotify = Class.create({\n    name: \"UserNotify\",\n    collection: new Mongo.Collection('user_notify'),\n    fields: {\n        userId: {\n            type: String,\n            default: ''\n        },\n        isRead: {\n            type: Boolean,\n            default: false\n        },\n        isPushed: {\n            type: Boolean,\n            default: false\n        },\n        isEmailed: {\n            type: Boolean,\n            default: false\n        },\n        title: {\n            type: String,\n            default: ''\n        },\n        body: {\n            type: String,\n            default: ''\n        },\n        action: {\n            type: String,\n            default: ''\n        },\n        createdDate: {\n            type: Date,\n            default: function () { return new Date(); }\n        }\n    },\n    meteorMethods: {\n        markRead() {\n            this.isRead = true;\n            this.save();\n        },\n        markNotified() {\n            this.isPushed = true;\n            this.save();\n        }\n    },\n    helpers: {\n        test() {\n            console.log(\"123\");\n        },\n        pushNotify(opts) {\n            let noteOpts = {\n                body: this.body,\n                icon: '/img/panda.png',\n                data: this._id\n            }\n            let browserNote;\n\n            if (!(\"Notification\" in window)) {\n                alert(\"This browser does not support desktop notification\");\n            }\n\n            // Let's check whether notification permissions have already been granted\n            else if (Notification.permission === \"granted\") {\n                // If it's okay let's create a notification\n                browserNote = new Notification(this.title, noteOpts);\n            }\n\n            // Otherwise, we need to ask the user for permission\n            else if (Notification.permission !== \"denied\") {\n                Notification.requestPermission(function (permission) {\n                    // If the user accepts, let's create a notification\n                    if (permission === \"granted\") {\n                        browserNote = new Notification(this.title, noteOpts);\n                    }\n                });\n            }\n            if (Notification.permission === \"granted\" && typeof opts.onclick !== 'undefined') {\n                browserNote.onclick = opts.onclick;\n            }\n        }\n    },\n    events: {\n        beforeSave(e) {\n            if (Meteor.isServer) {\n                let note = e.currentTarget;\n                if (!note.isEmailed) {\n                    let u = User.findOne( {_id:note.userId} );\n                    if (u) {\n                        let addr = u.emails[0].address;\n                        Email.send({\n                            to: addr,\n                            from: \"wayne@paladinarcher.com\",\n                            subject: \"Developer Level Notification - \"+note.title,\n                            text: note.body\n                        });\n                    }\n                }\n            }\n        }\n    }\n});\n\nif (Meteor.isClient) {\n    //\n}\n\nUserNotify.add = function(opts) {\n    let notify = new UserNotify(opts);\n    notify.save();\n}\n\nexport { UserNotify };\n"]},"sourceType":"script","hash":"d290d247c0d630b59977b6f51ff6f2520436bc03"}
