{"metadata":{},"options":{"plugins":[{"key":"base$0$0","visitor":{"Program":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"generateLetDeclarations":true,"enforceStrictMode":false}},{"key":"transform-meteor-dynamic-import","visitor":{"_exploded":{},"_verified":{},"CallExpression":{"enter":[null]}},"options":{}},{"key":"base$0$2","visitor":{"CallExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"MemberExpression":{"enter":[null],"exit":[null]},"_exploded":true,"_verified":true,"Identifier":{"enter":[null]},"JSXIdentifier":{"enter":[null]}},"options":{"polyfill":false,"useBuiltIns":true}},{"key":"base$0$3","visitor":{"_exploded":{},"_verified":{},"PrivateName":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]}},"options":{"loose":true}},{"key":"base$0$4","visitor":{"Program":{"exit":[null]},"_exploded":true,"_verified":true},"options":{"allowTopLevelThis":true,"strictMode":false,"loose":true}},{"key":"base$0$1$0","visitor":{"_exploded":{},"_verified":{},"JSXNamespacedName":{"enter":[null]},"JSXElement":{"exit":[null]},"JSXFragment":{"exit":[null]},"Program":{"enter":[null],"exit":[null]},"JSXAttribute":{"enter":[null]}},"options":{"pragma":"React.createElement","pragmaFrag":"React.Fragment","throwIfNamespace":true,"useBuiltIns":false}},{"key":"base$0$1$1","visitor":{"ExportDefaultDeclaration":{"enter":[null]},"CallExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$0","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$1","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$2","visitor":{"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$3","visitor":{"ForOfStatement":{"enter":[null]},"_exploded":true,"_verified":true},"options":{"loose":true}},{"key":"base$0$0$4","visitor":{"NumericLiteral":{"enter":[null]},"StringLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$5","visitor":{"TaggedTemplateExpression":{"enter":[null]},"TemplateLiteral":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$6","visitor":{"_exploded":true,"_verified":true,"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]}},"options":{}},{"key":"base$0$0$7","visitor":{"_exploded":{},"_verified":{},"VariableDeclarator":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]},"CatchClause":{"enter":[null]},"AssignmentExpression":{"enter":[null]},"ObjectExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"ForInStatement":{"enter":[null]},"ForOfStatement":{"enter":[null]}},"options":{}},{"key":"base$0$0$8","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]},"ImportDeclaration":{"enter":[null,null]},"ClassProperty":{"enter":[null]},"AssignmentPattern":{"enter":[null]},"TypeCastExpression":{"enter":[null,null]},"CallExpression":{"enter":[null]},"OptionalCallExpression":{"enter":[null]},"NewExpression":{"enter":[null]},"ImportSpecifier":{"enter":[null]},"ClassDeclaration":{"enter":[null]},"ClassExpression":{"enter":[null]},"FunctionDeclaration":{"enter":[null]},"FunctionExpression":{"enter":[null]},"ObjectMethod":{"enter":[null]},"ArrowFunctionExpression":{"enter":[null]},"ClassMethod":{"enter":[null]},"AnyTypeAnnotation":{"enter":[null]},"ArrayTypeAnnotation":{"enter":[null]},"BooleanTypeAnnotation":{"enter":[null]},"BooleanLiteralTypeAnnotation":{"enter":[null]},"NullLiteralTypeAnnotation":{"enter":[null]},"ClassImplements":{"enter":[null]},"DeclareClass":{"enter":[null]},"DeclareFunction":{"enter":[null]},"DeclareInterface":{"enter":[null]},"DeclareModule":{"enter":[null]},"DeclareModuleExports":{"enter":[null]},"DeclareTypeAlias":{"enter":[null]},"DeclareOpaqueType":{"enter":[null]},"DeclareVariable":{"enter":[null]},"DeclareExportDeclaration":{"enter":[null]},"DeclareExportAllDeclaration":{"enter":[null]},"DeclaredPredicate":{"enter":[null]},"ExistsTypeAnnotation":{"enter":[null]},"FunctionTypeAnnotation":{"enter":[null]},"FunctionTypeParam":{"enter":[null]},"GenericTypeAnnotation":{"enter":[null]},"InferredPredicate":{"enter":[null]},"InterfaceExtends":{"enter":[null]},"InterfaceDeclaration":{"enter":[null]},"InterfaceTypeAnnotation":{"enter":[null]},"IntersectionTypeAnnotation":{"enter":[null]},"MixedTypeAnnotation":{"enter":[null]},"EmptyTypeAnnotation":{"enter":[null]},"NullableTypeAnnotation":{"enter":[null]},"NumberLiteralTypeAnnotation":{"enter":[null]},"NumberTypeAnnotation":{"enter":[null]},"ObjectTypeAnnotation":{"enter":[null]},"ObjectTypeInternalSlot":{"enter":[null]},"ObjectTypeCallProperty":{"enter":[null]},"ObjectTypeIndexer":{"enter":[null]},"ObjectTypeProperty":{"enter":[null]},"ObjectTypeSpreadProperty":{"enter":[null]},"OpaqueType":{"enter":[null]},"QualifiedTypeIdentifier":{"enter":[null]},"StringLiteralTypeAnnotation":{"enter":[null]},"StringTypeAnnotation":{"enter":[null]},"ThisTypeAnnotation":{"enter":[null]},"TupleTypeAnnotation":{"enter":[null]},"TypeofTypeAnnotation":{"enter":[null]},"TypeAlias":{"enter":[null]},"TypeAnnotation":{"enter":[null]},"TypeParameter":{"enter":[null]},"TypeParameterDeclaration":{"enter":[null]},"TypeParameterInstantiation":{"enter":[null]},"UnionTypeAnnotation":{"enter":[null]},"Variance":{"enter":[null]},"VoidTypeAnnotation":{"enter":[null]},"ExportAllDeclaration":{"enter":[null]},"ExportDefaultDeclaration":{"enter":[null]},"ExportNamedDeclaration":{"enter":[null]}},"options":{}},{"key":"base$0$0$9","visitor":{"AssignmentExpression":{"enter":[null]},"BinaryExpression":{"enter":[null]},"_exploded":true,"_verified":true},"options":{}},{"key":"base$0$0$10","visitor":{"_exploded":{},"_verified":{},"Program":{"enter":[null]}},"options":{}}],"presets":[],"compact":false,"sourceMaps":true,"ast":true,"babelrc":false,"configFile":false,"parserOpts":{"sourceType":"module","sourceFileName":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan\\imports\\ui\\pages\\individual_goals\\individual_goals.js","plugins":["*","flow","jsx","asyncGenerators","bigInt","classPrivateMethods","classPrivateProperties","classProperties","doExpressions","dynamicImport","exportDefaultFrom","exportExtensions","exportNamespaceFrom","functionBind","functionSent","importMeta","nullishCoalescingOperator","numericSeparator","objectRestSpread","optionalCatchBinding","optionalChaining","pipelineOperator","throwExpressions","dynamicImport","classProperties","classPrivateProperties","jsx",["flow",{}],"asyncGenerators","objectRestSpread","objectRestSpread",["flow",{}],"asyncGenerators"],"allowImportExportEverywhere":true,"allowReturnOutsideFunction":true,"strictMode":false},"sourceFileName":"imports/ui/pages/individual_goals/individual_goals.js","filename":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan\\imports\\ui\\pages\\individual_goals\\individual_goals.js","passPerPreset":false,"envName":"development","cwd":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan","root":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan","generatorOpts":{"filename":"C:\\Users\\wayne\\src\\kwaiette\\tmp\\padawan\\imports\\ui\\pages\\individual_goals\\individual_goals.js","comments":true,"compact":false,"sourceMaps":true,"sourceFileName":"imports/ui/pages/individual_goals/individual_goals.js"}},"code":"let Meteor;\nmodule.watch(require(\"meteor/meteor\"), {\n  Meteor(v) {\n    Meteor = v;\n  }\n\n}, 0);\nlet User;\nmodule.watch(require(\"/imports/api/users/users.js\"), {\n  User(v) {\n    User = v;\n  }\n\n}, 1);\nlet Team;\nmodule.watch(require(\"/imports/api/teams/teams.js\"), {\n  Team(v) {\n    Team = v;\n  }\n\n}, 2);\nlet IndividualGoal;\nmodule.watch(require(\"/imports/api/individual_goals/individual_goals.js\"), {\n  IndividualGoal(v) {\n    IndividualGoal = v;\n  }\n\n}, 3);\nmodule.watch(require(\"./individual_goals.html\"));\nmodule.watch(require(\"/imports/ui/components/select_autocomplete/select_autocomplete.js\"));\nconst BLANK_GOAL = {\n  _id: \"new\",\n  title: \"\",\n  description: \"\"\n};\n\nlet _hasSubgoalView = new ReactiveVar(false);\n\nlet _subgoalId = new ReactiveVar(\"\");\n\nTemplate.individual_goals.onCreated(function () {\n  if (FlowRouter.getParam('userId')) {\n    this.userId = FlowRouter.getParam('userId');\n  } else {\n    this.userId = Meteor.userId();\n  }\n\n  Session.set(\"goal_user_id\", this.userId);\n  Session.set(\"goalReload\", false);\n  this.userSubscriptionReady = new ReactiveVar(false);\n  this.autorun(() => {\n    this.modalGoalId = FlowRouter.getParam('goalId');\n\n    if (\"undefined\" !== typeof this.modalGoalId && \"\" !== this.modalGoalId) {\n      _hasSubgoalView.set(true);\n\n      _subgoalId.set(FlowRouter.getParam('goalId'));\n\n      $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-sub\", function () {\n        _hasSubgoalView.set(false);\n\n        _subgoalId.set(\"\");\n\n        FlowRouter.go(\"/individualGoals/\" + FlowRouter.getParam('teamName'));\n      });\n      Meteor.setTimeout(function () {\n        $(\"#goal-modal-sub\").modal(\"show\");\n        $(\"#goal-modal-sub\").find(\"div.team-goal\").removeClass(\"collapsed\");\n      }, 1000);\n    }\n\n    this.subscription = this.subscribe('individualGoalsData', getUserId(), {\n      onStop: function () {\n        console.log(\"Team Goals subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Team Goals subscription ready! \", arguments, this);\n      }\n    });\n    this.subscription2 = this.subscribe('userList', Meteor.userId(), {\n      onStop: function () {\n        console.log(\"User List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"User List subscription ready! \", arguments, this);\n      }\n    });\n    this.subscription3 = this.subscribe('teamsMemberOfList', getUserId(), {\n      onStop: function () {\n        console.log(\"Team Member Of List subscription stopped! \", arguments, this);\n      },\n      onReady: function () {\n        console.log(\"Team Member Of List subscription ready! \", arguments, this);\n      }\n    });\n    console.log(this.subscription2);\n  });\n});\nTemplate.individual_goals.onRendered(function () {\n  Meteor.setTimeout(function () {\n    $(\"input.date\").datetimepicker({\n      format: 'YYYY-MM-DD',\n      useCurrent: false,\n      showClear: true,\n      showClose: true\n    });\n  }, 1000);\n  $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-new\", function () {\n    $newgoal = $(\"#div-goal-new\").detach();\n    $newgoal.data(\"parent-id\", \"\");\n    $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n  });\n});\n\nvar resetNewGoalForm = () => {\n  let valInputs = [\"goal-title-new\", \"goal-description-new\", \"input-date-due-new\", \"input-date-review-new\", \"input-date-reached-new\"];\n\n  for (let i = 0; i < valInputs.length; i++) {\n    $(\"#\" + valInputs[i]).val(\"\");\n  }\n};\n\nfunction saveGoal(goalId) {\n  let saveObj = {\n    title: $(\"#goal-title-\" + goalId).val(),\n    description: $(\"#goal-description-\" + goalId).val(),\n    userId: getUserId(),\n    teamId: $(\"#select-team-\" + goalId).val(),\n    privacy: $(\"#select-privacy-\" + goalId).val()\n  };\n  let startDate = $(\"#input-start-date-\" + goalId).val();\n\n  if (\"\" !== startDate) {\n    saveObj.startDate = new Date(startDate);\n  }\n\n  let dueDate = $(\"#input-date-due-\" + goalId).val();\n\n  if (\"\" !== dueDate) {\n    saveObj.dueDate = new Date(dueDate);\n  }\n\n  let rvwDate = $(\"#input-date-review-\" + goalId).val();\n\n  if (\"\" !== rvwDate) {\n    saveObj.reviewDate = new Date(rvwDate);\n  }\n\n  if (goalId === BLANK_GOAL._id) {\n    let parentId = $(\"#div-goal-new\").data(\"parent-id\");\n\n    if (\"\" !== parentId) {\n      saveObj.parentId = parentId;\n    }\n\n    Meteor.call('individualgoals.createNewGoal', saveObj, function (err, rslt) {\n      console.log(err, rslt);\n    });\n  } else {\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n    let reviewedOnDate = $(\"#input-date-reviewed-on-\" + goalId).val();\n\n    if (\"\" !== reviewedOnDate) {\n      saveObj.reviewedOnDate = new Date(reviewedOnDate);\n    }\n\n    let reachedDate = $(\"#input-date-reached-\" + goalId).val();\n\n    if (\"\" !== reachedDate) {\n      saveObj.reachedDate = new Date(reachedDate);\n    }\n\n    g.updateFromObj(saveObj);\n  }\n}\n\nfunction goalChanged($g) {\n  $g.find(\".btn-save\").prop(\"disabled\", false);\n  $g.find(\".btn-cancel\").prop(\"disabled\", false);\n}\n\nfunction goalUnchanged($g) {\n  $g.find(\".btn-save\").prop(\"disabled\", true);\n  $g.find(\".btn-cancel\").prop(\"disabled\", true);\n  $g.find(\".changed\").removeClass(\"changed\");\n}\n\nTemplate.individual_goals.events({\n  'change input.flat,textarea.flat'(event, instance) {\n    $(event.target).addClass('changed');\n    let $goal = $(event.target).closest(\"[data-goal-id]\");\n\n    if ($goal) {\n      if ($(\"#goal-title-\" + $goal.data(\"goal-id\")).val() != \"\") {//\n      }\n    }\n  },\n\n  'change input,textarea,select'(event, instance) {\n    let $t = $(event.target);\n    let $goal = $(event.target).closest(\"[data-goal-id]\");\n    goalChanged($goal);\n  },\n\n  'keyup input,textarea'(event, instance) {\n    let $t = $(event.target);\n    let $goal = $(event.target).closest(\"[data-goal-id]\");\n    goalChanged($goal);\n  },\n\n  'click button.btn-save'(event, instance) {\n    let $t = $(event.target);\n    let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n    saveGoal(goalId);\n    goalUnchanged($(\"#div-goal-\" + goalId));\n    $modalParent = $t.closest(\".modal\");\n\n    if ($modalParent.length) {\n      $modalParent.modal('hide');\n      $newgoal = $(\"#div-goal-new\").detach();\n      $newgoal.data(\"parent-id\", \"\");\n      $(\"#blank-goal\").find(\".col-sm-12\").html($newgoal);\n    }\n\n    if (goalId == BLANK_GOAL._id) {\n      resetNewGoalForm();\n\n      if (!$modalParent.length) {\n        $(\".goal-controls\").show();\n        $(\"#blank-goal\").slideUp();\n      }\n    }\n  },\n\n  'click button.btn-add-subgoal'(event, instance) {\n    let parentId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n    $newgoal = $(\"#div-goal-new\").detach();\n    $newgoal.data(\"parent-id\", parentId);\n    $newgoal.find(\".btn-cancel\").attr(\"disabled\", false);\n    $(\"#goal-modal-new\").find(\".modal-body\").append($newgoal);\n    $(\"#goal-modal-new\").modal(\"show\");\n    $(\"#goal-modal-new\").find(\"div.team-goal\").removeClass(\"collapsed\");\n  },\n\n  'click button.btn-cancel'(event, instance) {\n    let $t = $(event.target);\n    let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n    $modalParent = $t.closest(\".modal\");\n\n    if ($modalParent.length) {\n      $modalParent.modal('hide');\n      $newgoal = $(\"#div-goal-new\").detach();\n      $newgoal.data(\"parent-id\", \"\");\n      $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n    }\n\n    if (goalId == BLANK_GOAL._id) {\n      resetNewGoalForm();\n\n      if (!$modalParent.length) {\n        $(\".goal-controls\").show();\n        $(\"#blank-goal\").slideUp();\n      }\n    } else {\n      //forces a reload from the database\n      Session.set(\"goalReload\", true);\n      Meteor.setTimeout(function () {\n        Session.set(\"goalReload\", false);\n      }, 100);\n    }\n  },\n\n  'click button.btn-comment-add'(event, instance) {\n    $btnAdd = $(event.target);\n    let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n    let $comment = $(\"#new-comment-\" + goalId);\n    let newComment = $comment.val();\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n    g.addComment(newComment);\n    $comment.val(\"\");\n  },\n\n  'click button.btn-review-comment-add'(event, instance) {\n    $btnAdd = $(event.target);\n    let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n    let $comment = $(\"#new-review-comment-\" + goalId);\n    let newComment = $comment.val();\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n    g.addReviewComment(newComment);\n    $comment.val(\"\");\n  },\n\n  'click button#btn-add-goal'(event, instance) {\n    let $btnAdd = $(event.target);\n    $goal = $btnAdd.closest(\"[data-goal-id]\");\n    let goalId = $goal.data(\"goal-id\");\n    $(\".goal-controls\").hide();\n    let $btnCancel = $(\"#blank-goal\").find(\".btn-cancel\");\n    $btnCancel.prop(\"disabled\", false);\n    $(\".team-goal[data-goal-id=\" + goalId + \"]\").removeClass(\"collapsed\");\n    $(\"#blank-goal\").slideDown();\n    $(\"#btn-add-cancel\").fadeIn();\n  },\n\n  'click button#btn-add-cancel'(event, instance) {\n    $(\"#blank-goal\").slideUp();\n    $(\"#btn-add-cancel\").fadeOut();\n  },\n\n  'click button.btn-expand,div.collapsed-summary'(event, instance) {\n    let $target = $(event.target);\n    let $goalContainer = $target.closest(\"[data-goal-id]\");\n    let $targetExpandBtn = $goalContainer.find(\".btn-expand.glyphicon\");\n    $targetExpandBtn.removeClass(\"glyphicon-chevron-up\").addClass(\"glyphicon-chevron-down\");\n\n    if ($goalContainer.hasClass(\"collapsed\")) {\n      $(\".team-goal[data-goal-id]:not(.collapsed)\").slideUp(function () {\n        $(this).addClass(\"collapsed\").css(\"display\", \"block\");\n      });\n      $goalContainer.css(\"display\", \"none\").removeClass(\"collapsed\").slideDown(function () {\n        $('html, body').animate({\n          scrollTop: $goalContainer.offset().top\n        }, 500);\n      });\n      $targetExpandBtn.removeClass(\"glyphicon-chevron-down\");\n      $targetExpandBtn.addClass(\"glyphicon-chevron-up\");\n    } else {\n      $goalContainer.slideUp(function () {\n        $goalContainer.addClass(\"collapsed\").css(\"display\", \"block\");\n      });\n      $targetExpandBtn.removeClass(\"glyphicon-chevron-up\");\n      $targetExpandBtn.addClass(\"glyphicon-chevron-down\");\n    }\n  },\n\n  'keyup textarea.goal-description,input.goal-title': _.debounce(function (event, instance) {\n    let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n\n    if (\"new\" === goalId) {\n      //don't auto-save if creating a new goal\n      return;\n    }\n\n    saveGoal(goalId);\n    goalUnchanged($(\"#div-goal-\" + goalId));\n  }, 2000),\n  'change input,select': _.debounce(function (event, instance) {\n    if (!Session.get(\"saving\")) {\n      let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n\n      if (\"new\" === goalId) {\n        //don't auto-save if creating a new goal\n        return;\n      }\n\n      saveGoal(goalId);\n      goalUnchanged($(\"#div-goal-\" + goalId));\n    }\n  }, 2000),\n  'dp.change': _.debounce(function (event, instance) {\n    if (!Session.get(\"saving\")) {\n      let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n\n      if (\"new\" === goalId) {\n        //don't auto-save if creating a new goal\n        return;\n      }\n\n      saveGoal(goalId);\n      goalUnchanged($(\"#div-goal-\" + goalId));\n    }\n  }, 2000),\n\n  'click div.team-goal-title[data-id]'(event, instance) {\n    _hasSubgoalView.set(true);\n\n    let gid = $(event.target).data(\"id\");\n\n    _subgoalId.set(gid);\n\n    FlowRouter.go(\"/individualGoals/\" + FlowRouter.getParam('teamName') + \"/\" + gid);\n    $(\"#goal-modal-sub\").prop(\"disabled\", false).modal(\"show\");\n  }\n\n});\n\nfunction getUserId() {\n  return Session.get(\"goal_user_id\");\n}\n\nTemplate.individual_goals.helpers({\n  goalReload() {\n    return Session.get(\"goalReload\");\n  },\n\n  hasGoals() {\n    let uid = getUserId();\n    let g = IndividualGoal.find({\n      userId: uid,\n      parentId: ''\n    }).fetch();\n    return g.length > 0;\n  },\n\n  hasGoalsTeam(tid) {\n    let uid = getUserId();\n    let g = IndividualGoal.find({\n      userId: uid,\n      parentId: '',\n      teamId: tid\n    }).fetch();\n    return g.length > 0;\n  },\n\n  individualGoals() {\n    let uid = getUserId();\n    let g = IndividualGoal.find({\n      userId: uid,\n      parentId: ''\n    }).fetch();\n    return g;\n  },\n\n  individualGoalsTeam(tid) {\n    let uid = getUserId();\n    let g = IndividualGoal.find({\n      userId: uid,\n      parentId: '',\n      teamId: tid\n    }).fetch();\n    return g;\n  },\n\n  ownList() {\n    //check to see if the user logged in is the owner of the goals currently displayed\n    return Meteor.userId() === getUserId();\n  },\n\n  blankGoal() {\n    return Object.assign({\n      userId: getUserId()\n    }, BLANK_GOAL);\n  },\n\n  hasSubgoalView() {\n    let hasView = _hasSubgoalView.get();\n\n    let gid = _subgoalId.get();\n\n    if (hasView) {\n      return true;\n    } else {\n      return false;\n    }\n  },\n\n  subgoal() {\n    let hasView = _hasSubgoalView.get();\n\n    let subgoalId = Template.instance().modalGoalId;\n    subgoalId = _subgoalId.get();\n    let g = IndividualGoal.findOne({\n      _id: subgoalId\n    });\n\n    if (g) {\n      return g;\n    } else {\n      return {};\n    }\n  },\n\n  goalComments(goalId) {\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.goalComments;\n    return c;\n  },\n\n  reviewComments(goalId) {\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.reviewComments;\n    return c;\n  },\n\n  formatDate(dateObj) {\n    return dateObj.toLocaleDateString();\n  },\n\n  getUserName(userId) {\n    let u = User.findOne({\n      _id: userId\n    });\n    if (!u) return \"\";\n    let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n    return fullName;\n  },\n\n  userList() {\n    let list = [{\n      id: 1,\n      name: \"George\"\n    }, {\n      id: 2,\n      name: \"Frank\"\n    }];\n    return list;\n  },\n\n  teamList() {\n    //list of teams the user is a member of\n    let t = Team.find({\n      Members: getUserId()\n    });\n\n    if (!t) {\n      return [];\n    }\n\n    return t.fetch();\n  }\n\n}); //Template.igoal_view.onRendered(function () {\n//});\n\nTemplate.igoal_view.helpers({\n  childGoals() {\n    let goalId = Template.instance().data.goal._id;\n\n    let children = IndividualGoal.find({\n      parentId: goalId\n    }).fetch();\n    return children;\n  },\n\n  hasChildren() {\n    let goalId = Template.instance().data.goal._id;\n\n    let doesHave = IndividualGoal.find({\n      parentId: goalId\n    }).fetch().length > 0;\n    return doesHave;\n  },\n\n  goalComments(goalId) {\n    if (goalId === BLANK_GOAL._id) {\n      return;\n    }\n\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.goalComments;\n    return c;\n  },\n\n  reviewComments(goalId) {\n    if (goalId === BLANK_GOAL._id) {\n      return;\n    }\n\n    let g = IndividualGoal.findOne({\n      _id: goalId\n    });\n\n    if (!g) {\n      return;\n    }\n\n    let c = g.reviewComments;\n    return c;\n  },\n\n  formatDate(dateObj) {\n    return dateObj.toLocaleDateString();\n  },\n\n  dateField(fld) {\n    let goal = Template.instance().data.goal;\n\n    if (goal._id == BLANK_GOAL._id) {\n      return \"\";\n    }\n\n    let d = goal[fld];\n\n    if (!(d instanceof Date)) {\n      return \"\";\n    }\n\n    let dateText = new Date(d.getTime() - d.getTimezoneOffset() * 60000).toISOString().slice(0, -1);\n    return dateText;\n  },\n\n  getUserName(userId) {\n    let u = User.findOne({\n      _id: userId\n    });\n    if (!u) return \"\";\n    let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n    return fullName;\n  },\n\n  userList() {\n    let userList = [];\n    User.find({}).forEach(user => {\n      userList.push({\n        text: user.MyProfile.firstName + \" \" + user.MyProfile.lastName,\n        value: user._id\n      });\n    });\n    return userList;\n  },\n\n  progressPct() {\n    let goal = Template.instance().data.goal;\n    let g = IndividualGoal.findOne({\n      _id: goal._id\n    });\n    if (!g) return 0;\n\n    if (!g.dueDate || !g.startDate || \"undefined\" === typeof g.dueDate || \"undefined\" === typeof g.startDate) {\n      return 0;\n    }\n\n    let currDt = new Date().getTime();\n    let totalDuration = g.dueDate.getTime() - g.startDate.getTime();\n    let timeSinceStart = currDt - g.startDate.getTime();\n    let pct = timeSinceStart / totalDuration;\n    return Math.min(parseInt(pct * 100), 100);\n  },\n\n  ownList() {\n    //check to see if the user logged in is the owner of the goals currently displayed\n    return Meteor.userId() === getUserId();\n  },\n\n  userHasModifyPerm(fld) {\n    let goal = Template.instance().data.goal;\n    let g = IndividualGoal.findOne({\n      _id: goal._id\n    });\n    if (!g) return true;\n    return g.hasModifyPerm(fld);\n  },\n\n  fldEnabled(fld) {\n    let goal = Template.instance().data.goal;\n    let g = IndividualGoal.findOne({\n      _id: goal._id\n    });\n\n    if (!g) {\n      if (Roles.userIsInRole(Meteor.userId(), 'admin', goal.teamName)) {\n        return \"\";\n      } else {\n        return \"disabled\";\n      }\n    }\n\n    if (g.hasModifyPerm(fld)) {\n      return \"\";\n    } else {\n      return \"disabled\";\n    }\n  },\n\n  isNew(id) {\n    return BLANK_GOAL._id === id;\n  },\n\n  teamList() {\n    //list of teams the user is a member of\n    let t = Team.find();\n\n    if (!t) {\n      return [];\n    }\n\n    return t.fetch();\n  },\n\n  teamSelected(teamId) {\n    let goal = Template.instance().data.goal;\n    let g = IndividualGoal.findOne({\n      _id: goal._id\n    });\n\n    if (!g) {\n      return;\n    }\n\n    if (g.teamId === teamId) {\n      return \"selected\";\n    } else {\n      return \"\";\n    }\n  },\n\n  privacySelected(privVal) {\n    let goal = Template.instance().data.goal;\n    let g = IndividualGoal.findOne({\n      _id: goal._id\n    });\n\n    if (!g) {\n      return;\n    }\n\n    if (g.privacy === privVal) {\n      return \"selected\";\n    } else {\n      return \"\";\n    }\n  },\n\n  collapsed(pid) {\n    //if this goal has a parent it is being displayed in a modal and should not be collapsed\n    if (\"\" !== pid) {\n      return \"\";\n    } else {\n      return \"collapsed\";\n    }\n  }\n\n});\nTemplate.child_igoal_view.helpers({\n  childGoals() {\n    let goalId = Template.instance().data.goal._id;\n\n    let children = IndividualGoal.find({\n      parentId: goalId\n    }).fetch();\n    return children;\n  },\n\n  hasChildren(goalId) {\n    goalId = Template.instance().data.goal._id;\n    let doesHave = IndividualGoal.find({\n      parentId: goalId\n    }).count() > 0;\n    return doesHave;\n  }\n\n});","map":{"version":3,"sources":["imports/ui/pages/individual_goals/individual_goals.js"],"names":["Meteor","module","watch","require","v","User","Team","IndividualGoal","BLANK_GOAL","_id","title","description","_hasSubgoalView","ReactiveVar","_subgoalId","Template","individual_goals","onCreated","FlowRouter","getParam","userId","Session","set","userSubscriptionReady","autorun","modalGoalId","$","on","go","setTimeout","modal","find","removeClass","subscription","subscribe","getUserId","onStop","console","log","arguments","onReady","subscription2","subscription3","onRendered","datetimepicker","format","useCurrent","showClear","showClose","$newgoal","detach","data","append","resetNewGoalForm","valInputs","i","length","val","saveGoal","goalId","saveObj","teamId","privacy","startDate","Date","dueDate","rvwDate","reviewDate","parentId","call","err","rslt","g","findOne","reviewedOnDate","reachedDate","updateFromObj","goalChanged","$g","prop","goalUnchanged","events","event","instance","target","addClass","$goal","closest","$t","$modalParent","html","show","slideUp","attr","$btnAdd","$comment","newComment","addComment","addReviewComment","hide","$btnCancel","slideDown","fadeIn","fadeOut","$target","$goalContainer","$targetExpandBtn","hasClass","css","animate","scrollTop","offset","top","_","debounce","get","gid","helpers","goalReload","hasGoals","uid","fetch","hasGoalsTeam","tid","individualGoals","individualGoalsTeam","ownList","blankGoal","Object","assign","hasSubgoalView","hasView","subgoal","subgoalId","goalComments","c","reviewComments","formatDate","dateObj","toLocaleDateString","getUserName","u","fullName","MyProfile","firstName","lastName","userList","list","id","name","teamList","t","Members","igoal_view","childGoals","goal","children","hasChildren","doesHave","dateField","fld","d","dateText","getTime","getTimezoneOffset","toISOString","slice","forEach","user","push","text","value","progressPct","currDt","totalDuration","timeSinceStart","pct","Math","min","parseInt","userHasModifyPerm","hasModifyPerm","fldEnabled","Roles","userIsInRole","teamName","isNew","teamSelected","privacySelected","privVal","collapsed","pid","child_igoal_view","count"],"mappings":"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","sourcesContent":["import { Meteor } from 'meteor/meteor';\nimport { User } from '/imports/api/users/users.js';\nimport { Team } from '/imports/api/teams/teams.js';\nimport { IndividualGoal } from '/imports/api/individual_goals/individual_goals.js';\nimport './individual_goals.html';\nimport '/imports/ui/components/select_autocomplete/select_autocomplete.js';\n\nconst BLANK_GOAL = {\n    _id: \"new\",\n    title: \"\",\n    description: \"\"\n};\n\nlet _hasSubgoalView = new ReactiveVar(false);\nlet _subgoalId = new ReactiveVar(\"\");\nTemplate.individual_goals.onCreated(function () {\n    if (FlowRouter.getParam('userId')) {\n        this.userId = FlowRouter.getParam('userId');\n    } else {\n        this.userId = Meteor.userId();\n    }\n    Session.set(\"goal_user_id\",this.userId);\n    Session.set(\"goalReload\",false);\n\n    this.userSubscriptionReady = new ReactiveVar( false );\n    this.autorun( () => {\n        this.modalGoalId = FlowRouter.getParam('goalId');\n        if (\"undefined\" !== typeof this.modalGoalId && \"\" !== this.modalGoalId) {\n            _hasSubgoalView.set(true);\n            _subgoalId.set(FlowRouter.getParam('goalId'));\n            $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-sub\", function () {\n                _hasSubgoalView.set(false);\n                _subgoalId.set(\"\");\n                FlowRouter.go(\"/individualGoals/\"+FlowRouter.getParam('teamName'));\n            });\n            Meteor.setTimeout(function () {\n                $(\"#goal-modal-sub\").modal(\"show\");\n                $(\"#goal-modal-sub\").find(\"div.team-goal\").removeClass(\"collapsed\");\n            }, 1000);\n        }\n        this.subscription = this.subscribe('individualGoalsData', getUserId(), {\n            onStop: function () {\n                console.log(\"Team Goals subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"Team Goals subscription ready! \", arguments, this);\n            }\n        });\n        this.subscription2 = this.subscribe('userList', Meteor.userId(), {\n            onStop: function () {\n                console.log(\"User List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"User List subscription ready! \", arguments, this);\n            }\n        });\n        this.subscription3 = this.subscribe('teamsMemberOfList', getUserId(), {\n            onStop: function () {\n                console.log(\"Team Member Of List subscription stopped! \", arguments, this);\n            },\n            onReady: function () {\n                console.log(\"Team Member Of List subscription ready! \", arguments, this);\n            }\n        });\n        console.log(this.subscription2);\n    });\n});\nTemplate.individual_goals.onRendered(function () {\n    Meteor.setTimeout(function() {\n        $(\"input.date\").datetimepicker({\n            format:'YYYY-MM-DD',\n            useCurrent:false,\n            showClear:true,\n            showClose:true\n        });\n    }, 1000);\n    $(\"body\").on(\"hidden.bs.modal\", \"#goal-modal-new\", function () {\n        $newgoal = $(\"#div-goal-new\").detach();\n        $newgoal.data(\"parent-id\",\"\");\n        $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n    });\n});\n\nvar resetNewGoalForm = () => {\n    let valInputs = [\n        \"goal-title-new\",\n        \"goal-description-new\",\n        \"input-date-due-new\",\n        \"input-date-review-new\",\n        \"input-date-reached-new\",\n    ];\n    for (let i = 0; i < valInputs.length; i++) {\n        $(\"#\"+valInputs[i]).val(\"\");\n    }\n};\n\nfunction saveGoal(goalId) {\n    let saveObj = {\n        title: $(\"#goal-title-\"+goalId).val(),\n        description: $(\"#goal-description-\"+goalId).val(),\n        userId: getUserId(),\n        teamId: $(\"#select-team-\"+goalId).val(),\n        privacy: $(\"#select-privacy-\"+goalId).val()\n    };\n    let startDate = $(\"#input-start-date-\"+goalId).val();\n    if (\"\" !== startDate) {\n        saveObj.startDate = new Date(startDate);\n    }\n    let dueDate = $(\"#input-date-due-\"+goalId).val();\n    if (\"\" !== dueDate) {\n        saveObj.dueDate = new Date(dueDate);\n    }\n    let rvwDate = $(\"#input-date-review-\"+goalId).val();\n    if (\"\" !== rvwDate) {\n        saveObj.reviewDate = new Date(rvwDate);\n    }\n\n    if (goalId === BLANK_GOAL._id) {\n        let parentId = $(\"#div-goal-new\").data(\"parent-id\");\n        if (\"\" !== parentId) {\n            saveObj.parentId = parentId;\n        }\n        Meteor.call('individualgoals.createNewGoal', saveObj, function (err, rslt) {\n            console.log(err, rslt);\n        });\n    } else {\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        let reviewedOnDate = $(\"#input-date-reviewed-on-\"+goalId).val();\n        if (\"\" !== reviewedOnDate) {\n            saveObj.reviewedOnDate = new Date(reviewedOnDate);\n        }\n        let reachedDate = $(\"#input-date-reached-\"+goalId).val();\n        if (\"\" !== reachedDate) {\n            saveObj.reachedDate = new Date(reachedDate);\n        }\n\n        g.updateFromObj(saveObj);\n    }\n}\n\nfunction goalChanged($g) {\n    $g.find(\".btn-save\").prop(\"disabled\",false);\n    $g.find(\".btn-cancel\").prop(\"disabled\",false);\n}\nfunction goalUnchanged($g) {\n    $g.find(\".btn-save\").prop(\"disabled\",true);\n    $g.find(\".btn-cancel\").prop(\"disabled\",true);\n    $g.find(\".changed\").removeClass(\"changed\");\n}\n\nTemplate.individual_goals.events({\n    'change input.flat,textarea.flat'(event, instance) {\n        $(event.target).addClass('changed');\n        let $goal = $(event.target).closest(\"[data-goal-id]\");\n        if ($goal) {\n            if ($(\"#goal-title-\"+$goal.data(\"goal-id\")).val() != \"\") {\n                //\n            }\n        }\n    },\n    'change input,textarea,select'(event, instance) {\n        let $t = $(event.target);\n        let $goal = $(event.target).closest(\"[data-goal-id]\");\n        goalChanged($goal);\n    },\n    'keyup input,textarea'(event, instance) {\n        let $t = $(event.target);\n        let $goal = $(event.target).closest(\"[data-goal-id]\");\n        goalChanged($goal);\n    },\n    'click button.btn-save'(event, instance) {\n        let $t = $(event.target);\n        let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n        saveGoal(goalId);\n        goalUnchanged($(\"#div-goal-\"+goalId));\n\n        $modalParent = $t.closest(\".modal\");\n        if ($modalParent.length) {\n            $modalParent.modal('hide');\n            $newgoal = $(\"#div-goal-new\").detach();\n            $newgoal.data(\"parent-id\",\"\");\n            $(\"#blank-goal\").find(\".col-sm-12\").html($newgoal);\n        }\n        if (goalId == BLANK_GOAL._id) {\n            resetNewGoalForm();\n            if ( ! $modalParent.length ) {\n                $(\".goal-controls\").show();\n                $(\"#blank-goal\").slideUp();\n            }\n        }\n    },\n    'click button.btn-add-subgoal'(event, instance) {\n        let parentId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n        $newgoal = $(\"#div-goal-new\").detach();\n        $newgoal.data(\"parent-id\",parentId);\n        $newgoal.find(\".btn-cancel\").attr(\"disabled\",false);\n        $(\"#goal-modal-new\").find(\".modal-body\").append($newgoal);\n        $(\"#goal-modal-new\").modal(\"show\");\n        $(\"#goal-modal-new\").find(\"div.team-goal\").removeClass(\"collapsed\");\n    },\n    'click button.btn-cancel'(event, instance) {\n        let $t = $(event.target);\n        let goalId = $t.closest(\"[data-goal-id]\").data(\"goal-id\");\n\n        $modalParent = $t.closest(\".modal\");\n        if ($modalParent.length) {\n            $modalParent.modal('hide');\n            $newgoal = $(\"#div-goal-new\").detach();\n            $newgoal.data(\"parent-id\",\"\");\n            $(\"#blank-goal\").find(\".col-sm-12\").append($newgoal);\n        }\n\n        if (goalId == BLANK_GOAL._id) {\n            resetNewGoalForm();\n            if ( ! $modalParent.length ) {\n                $(\".goal-controls\").show();\n                $(\"#blank-goal\").slideUp();\n            }\n        } else {\n            //forces a reload from the database\n            Session.set(\"goalReload\",true);\n            Meteor.setTimeout(function () {\n                Session.set(\"goalReload\",false);\n            }, 100);\n        }\n    },\n    'click button.btn-comment-add'(event, instance) {\n        $btnAdd = $(event.target);\n\n        let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n        let $comment = $(\"#new-comment-\"+goalId);\n        let newComment = $comment.val();\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        g.addComment(newComment);\n        $comment.val(\"\");\n    },\n    'click button.btn-review-comment-add'(event, instance) {\n        $btnAdd = $(event.target);\n\n        let goalId = $btnAdd.closest(\"[data-goal-id]\").data(\"goal-id\");\n        let $comment = $(\"#new-review-comment-\"+goalId);\n        let newComment = $comment.val();\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        g.addReviewComment(newComment);\n        $comment.val(\"\");\n    },\n    'click button#btn-add-goal'(event, instance) {\n        let $btnAdd = $(event.target);\n        $goal = $btnAdd.closest(\"[data-goal-id]\")\n        let goalId = $goal.data(\"goal-id\");\n\n        $(\".goal-controls\").hide();\n        let $btnCancel = $(\"#blank-goal\").find(\".btn-cancel\")\n        $btnCancel.prop(\"disabled\",false);\n        $(\".team-goal[data-goal-id=\"+goalId+\"]\").removeClass(\"collapsed\");\n        $(\"#blank-goal\").slideDown();\n        $(\"#btn-add-cancel\").fadeIn();\n    },\n    'click button#btn-add-cancel'(event, instance) {\n        $(\"#blank-goal\").slideUp();\n        $(\"#btn-add-cancel\").fadeOut();\n    },\n    'click button.btn-expand,div.collapsed-summary'(event, instance) {\n        let $target = $(event.target);\n        let $goalContainer = $target.closest(\"[data-goal-id]\");\n        let $targetExpandBtn = $goalContainer.find(\".btn-expand.glyphicon\");\n\n        $targetExpandBtn.removeClass(\"glyphicon-chevron-up\")\n            .addClass(\"glyphicon-chevron-down\");\n\n        if ($goalContainer.hasClass(\"collapsed\")) {\n            $(\".team-goal[data-goal-id]:not(.collapsed)\").slideUp(function() {\n                $(this).addClass(\"collapsed\").css(\"display\",\"block\");\n            });\n            $goalContainer.css(\"display\",\"none\").removeClass(\"collapsed\").slideDown(function () {\n                $('html, body').animate({\n                    scrollTop: ($goalContainer.offset().top)\n                },500);\n            });\n            $targetExpandBtn.removeClass(\"glyphicon-chevron-down\");\n            $targetExpandBtn.addClass(\"glyphicon-chevron-up\");\n        } else {\n            $goalContainer.slideUp(function() {\n                $goalContainer.addClass(\"collapsed\").css(\"display\",\"block\");\n            });\n            $targetExpandBtn.removeClass(\"glyphicon-chevron-up\");\n            $targetExpandBtn.addClass(\"glyphicon-chevron-down\");\n        }\n    },\n    'keyup textarea.goal-description,input.goal-title':_.debounce(function (event, instance) {\n        let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n        if (\"new\" === goalId) {\n            //don't auto-save if creating a new goal\n            return;\n        }\n        saveGoal(goalId);\n        goalUnchanged($(\"#div-goal-\"+goalId));\n    }, 2000),\n    'change input,select':_.debounce(function (event, instance) {\n        if (!Session.get(\"saving\")) {\n            let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n            if (\"new\" === goalId) {\n                //don't auto-save if creating a new goal\n                return;\n            }\n            saveGoal(goalId);\n            goalUnchanged($(\"#div-goal-\"+goalId));\n        }\n    }, 2000),\n    'dp.change':_.debounce(function (event, instance) {\n        if (!Session.get(\"saving\")) {\n            let goalId = $(event.target).closest(\"[data-goal-id]\").data(\"goal-id\");\n            if (\"new\" === goalId) {\n                //don't auto-save if creating a new goal\n                return;\n            }\n            saveGoal(goalId);\n            goalUnchanged($(\"#div-goal-\"+goalId));\n        }\n    }, 2000),\n    'click div.team-goal-title[data-id]'(event, instance) {\n        _hasSubgoalView.set(true);\n        let gid = $(event.target).data(\"id\");\n        _subgoalId.set(gid);\n        FlowRouter.go(\"/individualGoals/\"+FlowRouter.getParam('teamName')+\"/\"+gid);\n        $(\"#goal-modal-sub\").prop(\"disabled\",false).modal(\"show\");\n    }\n});\n\nfunction getUserId() {\n    return Session.get(\"goal_user_id\");\n}\nTemplate.individual_goals.helpers({\n    goalReload() {\n        return Session.get(\"goalReload\");\n    },\n    hasGoals() {\n        let uid = getUserId();\n        let g = IndividualGoal.find( {userId: uid, parentId: ''} ).fetch();\n        return g.length > 0;\n    },\n    hasGoalsTeam(tid) {\n        let uid = getUserId();\n        let g = IndividualGoal.find( {userId: uid, parentId: '', teamId: tid} ).fetch();\n        return g.length > 0;\n    },\n    individualGoals() {\n        let uid = getUserId();\n        let g = IndividualGoal.find( {userId: uid, parentId: ''} ).fetch();\n        return g;\n    },\n    individualGoalsTeam(tid) {\n        let uid = getUserId();\n        let g = IndividualGoal.find( {userId: uid, parentId: '', teamId: tid} ).fetch();\n        return g;\n    },\n    ownList() {\n        //check to see if the user logged in is the owner of the goals currently displayed\n        return (Meteor.userId() === getUserId());\n    },\n    blankGoal() {\n        return Object.assign({userId: getUserId()}, BLANK_GOAL);\n    },\n    hasSubgoalView() {\n        let hasView = _hasSubgoalView.get();\n        let gid = _subgoalId.get();\n        if (hasView) {\n            return true;\n        } else {\n            return false;\n        }\n    },\n    subgoal() {\n        let hasView = _hasSubgoalView.get();\n        let subgoalId = Template.instance().modalGoalId;\n        subgoalId = _subgoalId.get();\n        let g = IndividualGoal.findOne( {_id: subgoalId} );\n        if (g) {\n            return g;\n        } else {\n            return {};\n        }\n    },\n    goalComments(goalId) {\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.goalComments;\n        return c;\n    },\n    reviewComments(goalId) {\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.reviewComments;\n        return c;\n    },\n    formatDate(dateObj) {\n        return dateObj.toLocaleDateString();\n    },\n    getUserName(userId) {\n        let u = User.findOne( {_id: userId} );\n        if (!u) return \"\";\n        let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n        return fullName;\n    },\n    userList() {\n        let list = [\n            {id: 1, name: \"George\"},\n            {id: 2, name: \"Frank\"}\n        ];\n        return list;\n    },\n    teamList() {\n        //list of teams the user is a member of\n        let t = Team.find( {Members: getUserId()} );\n        if (!t) {\n            return [];\n        }\n        return t.fetch();\n    },\n});\n\n//Template.igoal_view.onRendered(function () {\n//});\n\nTemplate.igoal_view.helpers({\n    childGoals() {\n        let goalId = Template.instance().data.goal._id;\n        let children = IndividualGoal.find( {parentId: goalId} ).fetch();\n        return children;\n    },\n    hasChildren() {\n        let goalId = Template.instance().data.goal._id;\n        let doesHave = IndividualGoal.find( {parentId: goalId} ).fetch().length > 0;\n        return doesHave;\n    },\n    goalComments(goalId) {\n        if (goalId === BLANK_GOAL._id) {\n            return;\n        }\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.goalComments;\n        return c;\n    },\n    reviewComments(goalId) {\n        if (goalId === BLANK_GOAL._id) {\n            return;\n        }\n        let g = IndividualGoal.findOne( {_id: goalId} );\n        if (!g) {\n            return;\n        }\n        let c = g.reviewComments;\n        return c;\n    },\n    formatDate(dateObj) {\n        return dateObj.toLocaleDateString();\n    },\n    dateField(fld) {\n        let goal = Template.instance().data.goal;\n        if (goal._id == BLANK_GOAL._id) {\n            return \"\";\n        }\n        let d = goal[fld];\n        if ( !(d instanceof Date) ) {\n            return \"\";\n        }\n        let dateText = new Date(d.getTime() - d.getTimezoneOffset()*60000).toISOString().slice(0,-1);\n        return dateText;\n    },\n    getUserName(userId) {\n        let u = User.findOne( {_id: userId} );\n        if (!u) return \"\";\n        let fullName = u.MyProfile.firstName + \" \" + u.MyProfile.lastName;\n        return fullName;\n    },\n    userList() {\n        let userList = [];\n        User.find( {} ).forEach( (user) => {\n            userList.push({\n                text: user.MyProfile.firstName + \" \" + user.MyProfile.lastName,\n                value: user._id\n            })\n        });\n        return userList;\n    },\n    progressPct() {\n        let goal = Template.instance().data.goal;\n        let g = IndividualGoal.findOne( {_id: goal._id} );\n        if (!g) return 0;\n\n        if (!g.dueDate || !g.startDate || \"undefined\" === typeof g.dueDate || \"undefined\" === typeof g.startDate) {\n            return 0;\n        }\n        let currDt = new Date().getTime();\n        let totalDuration = g.dueDate.getTime() - g.startDate.getTime();\n        let timeSinceStart = currDt - g.startDate.getTime();\n        let pct = (timeSinceStart / totalDuration);\n        return Math.min(parseInt(pct*100),100);\n    },\n    ownList() {\n        //check to see if the user logged in is the owner of the goals currently displayed\n        return (Meteor.userId() === getUserId());\n    },\n    userHasModifyPerm(fld) {\n        let goal = Template.instance().data.goal;\n        let g = IndividualGoal.findOne( {_id: goal._id} );\n        if (!g) return true;\n        return g.hasModifyPerm(fld);\n    },\n    fldEnabled(fld) {\n        let goal = Template.instance().data.goal;\n        let g = IndividualGoal.findOne( {_id: goal._id} );\n\n        if (!g) {\n            if (Roles.userIsInRole(Meteor.userId(), 'admin', goal.teamName)) {\n                return \"\";\n            } else {\n                return \"disabled\";\n            }\n        }\n\n        if (g.hasModifyPerm(fld)) {\n            return \"\";\n        } else {\n            return \"disabled\";\n        }\n    },\n    isNew(id) {\n        return BLANK_GOAL._id === id;\n    },\n    teamList() {\n        //list of teams the user is a member of\n        let t = Team.find(  );\n        if (!t) {\n            return [];\n        }\n        return t.fetch();\n    },\n    teamSelected(teamId) {\n        let goal = Template.instance().data.goal;\n        let g = IndividualGoal.findOne( {_id: goal._id} );\n        if (!g) {\n            return;\n        }\n        if (g.teamId === teamId) {\n            return \"selected\";\n        } else {\n            return \"\";\n        }\n    },\n    privacySelected(privVal) {\n        let goal = Template.instance().data.goal;\n        let g = IndividualGoal.findOne( {_id: goal._id} );\n        if (!g) {\n            return;\n        }\n        if (g.privacy === privVal) {\n            return \"selected\";\n        } else {\n            return \"\";\n        }\n    },\n    collapsed(pid) {\n        //if this goal has a parent it is being displayed in a modal and should not be collapsed\n        if (\"\" !== pid) {\n            return \"\";\n        } else {\n            return \"collapsed\";\n        }\n    }\n})\nTemplate.child_igoal_view.helpers({\n    childGoals() {\n        let goalId = Template.instance().data.goal._id;\n        let children = IndividualGoal.find( {parentId: goalId} ).fetch();\n        return children;\n    },\n    hasChildren(goalId) {\n        goalId = Template.instance().data.goal._id;\n        let doesHave = IndividualGoal.find( {parentId: goalId} ).count() > 0;\n        return doesHave;\n    }\n});\n"]},"sourceType":"script","hash":"f39ee82496741a7f214775699048d1172bc02e59"}
